<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.9.1 by Michael Rose
  Copyright 2013-2018 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="zh" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Bash 入门 02 - LINOTES</title>
<meta name="description" content="正则表达式，SED，AWK，条件结构，交互式脚本">



<meta property="og:type" content="article">
<meta property="og:locale" content="zh_CN">
<meta property="og:site_name" content="LINOTES">
<meta property="og:title" content="Bash 入门 02">
<meta property="og:url" content="http://localhost:4000/programming/bash02/">


  <meta property="og:description" content="正则表达式，SED，AWK，条件结构，交互式脚本">



  <meta property="og:image" content="http://localhost:4000/assets/images/header/backup.jpg">



  <meta name="twitter:site" content="@liloli">
  <meta name="twitter:title" content="Bash 入门 02">
  <meta name="twitter:description" content="正则表达式，SED，AWK，条件结构，交互式脚本">
  <meta name="twitter:url" content="http://localhost:4000/programming/bash02/">

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="http://localhost:4000/assets/images/header/backup.jpg">
  

  



  <meta property="article:published_time" content="2017-05-03T00:00:00+08:00">





  

  


<link rel="canonical" href="http://localhost:4000/programming/bash02/">







  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "Hawk Zhang",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="LINOTES Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- <link rel="stylesheet" href="/assets/css/vim.css"> -->



  









<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="http://localhost:4000/">LINOTES</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/app/rsync/" >Rsync 的用法</a>
            </li>
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/server/vsftpd/" >Vsftpd 的用法</a>
            </li>
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/kernel/filedescriptor/" >文件描述符简介</a>
            </li>
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/tools/tools.datastream/" >数据流处理</a>
            </li>
          
        </ul>
        
        <button class="search__toggle" type="button">
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">切换菜单</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    <div class="initial-content">
      
  











<div class="page__hero--overlay"
  style=" background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('http://localhost:4000/assets/images/header/backup.jpg');"
>
  
    <div class="wrapper">
      <h1 class="page__title" itemprop="headline">
        
          Bash 入门 02

        
      </h1>
      
        <p class="page__lead">正则表达式，SED，AWK，条件结构，交互式脚本
</p>
      
      
      
    </div>
  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="http://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="http://localhost:4000/assets/images/bio-photo.jpg" alt="Hawk Zhang" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Hawk Zhang</h3>
    
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">关注</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">北京</span>
        </li>
      

      

      
        <li>
          <a href="mailto:liloli@gmail.com">
            <meta itemprop="email" content="liloli@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> 电子邮箱
          </a>
        </li>
      

      

      
        <li>
          <a href="https://twitter.com/liloli" itemprop="sameAs">
            <i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter
          </a>
        </li>
      

      

      

      
        <li>
          <a href="https://www.linkedin.com/in/hawkzhang" itemprop="sameAs">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://github.com/liloli" itemprop="sameAs">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
    
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">切换菜单</label>
  <ul class="nav__items">
    
  </ul>
</nav>
    
  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Bash 入门 02">
    <meta itemprop="description" content="正则表达式，SED，AWK，条件结构，交互式脚本">
    <meta itemprop="datePublished" content="May 03, 2017">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-code"></i> Bash 入门 02</h4></header>
              <ul class="toc__menu">
  <li><a href="#4-正则表达式">4. 正则表达式</a>
    <ul>
      <li><a href="#41-正则表达式">4.1 正则表达式</a></li>
      <li><a href="#42-用-grep-做范例">4.2 用 GREP 做范例</a></li>
      <li><a href="#43-用-bash-的功能来匹配">4.3 用 bash 的功能来匹配</a></li>
    </ul>
  </li>
  <li><a href="#5-sed">5. SED</a>
    <ul>
      <li><a href="#51-sed-简介">5.1 SED 简介</a></li>
      <li><a href="#52-交互式编辑">5.2 交互式编辑</a></li>
      <li><a href="#53-非交互式编辑">5.3 非交互式编辑</a></li>
    </ul>
  </li>
  <li><a href="#6-awk">6. AWK</a>
    <ul>
      <li><a href="#61-从-gawk-开始">6.1 从 gawk 开始</a></li>
      <li><a href="#62-print-程序">6.2 print 程序</a></li>
      <li><a href="#63-gawk-变量">6.3 gawk 变量</a></li>
    </ul>
  </li>
  <li><a href="#7-条件语句">7. 条件语句</a>
    <ul>
      <li><a href="#71-if-简介">7.1 if 简介</a></li>
      <li><a href="#72-if-高级应用">7.2 if 高级应用</a></li>
      <li><a href="#73-case-语句">7.3 case 语句</a></li>
    </ul>
  </li>
  <li><a href="#8-编写交互式脚本">8. 编写交互式脚本</a>
    <ul>
      <li><a href="#81-显示用户消息">8.1 显示用户消息</a></li>
      <li><a href="#82-捕捉用户的输入">8.2 捕捉用户的输入</a></li>
    </ul>
  </li>
</ul>
            </nav>
          </aside>
        
        <h2 id="4-正则表达式">4. 正则表达式</h2>

<p>Regular Expressions</p>

<h3 id="41-正则表达式">4.1 正则表达式</h3>

<h4 id="411-正则表达式简介">4.1.1 正则表达式简介</h4>

<p>正则表达式就是用模板来表示一组字符。</p>

<p>与算术表达式类似，正则表达式也是通过 “用各种操作符连接较小的表达式” 而构建起来的。</p>

<p>基本的组件是用来匹配 <strong>单个字符</strong> 的表达式。包括所有字母及标点在内的大部分字符都可用来匹配自己。有特殊含义的 <strong>元字符</strong> 可以用 <strong>反斜线</strong> 来转义。</p>

<h4 id="412-正则表达式元字符">4.1.2 正则表达式元字符</h4>

<p>一个正则表达式后面可以跟一个或多个 <strong>元字符</strong>。</p>

<blockquote>
  <p>元字符：一个字符，并不仅仅表示它自身，而是有特殊的含义。</p>
</blockquote>

<p>正则表达式操作符：</p>

<table>
  <thead>
    <tr>
      <th>操作符</th>
      <th>效果</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">.</code></td>
      <td>匹配任何单个字符</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">?</code></td>
      <td>最多匹配一次</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">+</code></td>
      <td>最少匹配一次</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">*</code></td>
      <td>任意次匹配（零或更多次）</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">{N}</code></td>
      <td>前面字符串匹配 N 次</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">{N,}</code></td>
      <td>前面字符串匹配 N 或更多次</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">{N,M}</code></td>
      <td>前面字符串匹配 N ~ M 次</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">-</code></td>
      <td>若其不在列表的两头、不是列表中某范围的结束点，代表范围</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">^</code></td>
      <td>匹配行首空字符，或把字符串从范围排除</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">$</code></td>
      <td>匹配行尾空字符</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\b</code></td>
      <td>匹配字段外沿相邻空字符</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\B</code></td>
      <td>匹配字段外非相邻空字符</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\&lt;</code></td>
      <td>匹配字段开头空字符</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\&gt;</code></td>
      <td>匹配字段结尾空字符</td>
    </tr>
  </tbody>
</table>

<h5 id="各操作的优先级">各操作的优先级</h5>

<p>处理优先级从高到低：</p>

<ul>
  <li><code class="highlighter-rouge">(R)</code> 组合操作</li>
  <li><code class="highlighter-rouge">R*</code> 数量限定操作</li>
  <li><code class="highlighter-rouge">R1R2</code> 串接操作</li>
  <li><code class="highlighter-rouge">R1 | R2</code> 选择操作</li>
</ul>

<p>为了避免括号，星号有最高优先级，接着是串接，接着是选择。如果没有歧义则可以省略括号。</p>

<p>因此 <code class="highlighter-rouge">ab*c|d</code> 会被解析为 <code class="highlighter-rouge">((a(b*))c)|d</code>。解析流程：</p>

<ul>
  <li>因为没有括号，所以首先处理数量限定操作 <code class="highlighter-rouge">b*</code>，得到 <code class="highlighter-rouge">(b*)</code></li>
  <li>再处理串接操作 <code class="highlighter-rouge">a(b*)c</code>，得到 <code class="highlighter-rouge">(a(b*)c)</code></li>
  <li>最后处理选择操作，得到 <code class="highlighter-rouge">((a(b*))c)|d</code></li>
</ul>

<h6 id="组合操作">组合操作</h6>

<p>用 <strong>括号</strong> 把字符强制组合在一起，组合操作具有最高优先级。</p>

<p><code class="highlighter-rouge">go!(go!)*</code> 匹配 <code class="highlighter-rouge">go!</code>、<code class="highlighter-rouge">go!go!</code>、<code class="highlighter-rouge">go!go!go!</code> 等。</p>

<h6 id="数量限定操作">数量限定操作</h6>

<p>用 <code class="highlighter-rouge">+</code>、<code class="highlighter-rouge">?</code>、<code class="highlighter-rouge">*</code> 等操作符来限定左侧字符串出现的次数。</p>

<p><code class="highlighter-rouge">booo*</code> 匹配 <code class="highlighter-rouge">boo</code>、<code class="highlighter-rouge">booo</code>、<code class="highlighter-rouge">boooo</code> 等。</p>

<h6 id="串接操作">串接操作</h6>

<p>Concatenation</p>

<p>把两个正则表达式直接放在一起就是串接操作。相邻的字符默认为串接关系。</p>

<p><code class="highlighter-rouge">f</code> 串接 <code class="highlighter-rouge">o</code> 得到 <code class="highlighter-rouge">fo</code>，只匹配 <code class="highlighter-rouge">fo</code></p>

<p><code class="highlighter-rouge">f</code> 串接 <code class="highlighter-rouge">o*</code> 得到 <code class="highlighter-rouge">fo*</code>，匹配 <code class="highlighter-rouge">fo</code>、<code class="highlighter-rouge">for</code>、<code class="highlighter-rouge">foo</code>、<code class="highlighter-rouge">fool</code> 等</p>

<h6 id="选择操作">选择操作</h6>

<p>Alternation</p>

<p>两个正则表达式可以用 <code class="highlighter-rouge">|</code> 操作符连接起来，得到的表达式匹配它们的 <strong>或集</strong>。</p>

<p><code class="highlighter-rouge">trick|treat</code> 匹配 <code class="highlighter-rouge">trick</code> 或 <code class="highlighter-rouge">treat</code></p>

<h4 id="413-基本正则表达式与扩展正则表达式">4.1.3 基本正则表达式与扩展正则表达式</h4>

<p>POSIX 定义了两种正则表达式语法：基本正则表达式（BRE）和扩展正则表达式（ERE）。</p>

<p>在 BRE 中，这些元字符失去了其特殊功能，要想让它们再做为元字符使用，必须用反斜线转义：</p>

<p><code class="highlighter-rouge">?</code>、<code class="highlighter-rouge">+</code>、<code class="highlighter-rouge">{</code>、<code class="highlighter-rouge">|</code>、<code class="highlighter-rouge">(</code>、<code class="highlighter-rouge">)</code></p>

<p><strong>BRE 定义的语法符号</strong> 包括：</p>

<p><code class="highlighter-rouge">.</code>       - 匹配任意一个字符。</p>

<p><code class="highlighter-rouge">[]</code>      - 字符集匹配，匹配方括号中定义的字符集之一。</p>

<p><code class="highlighter-rouge">[^]</code>     - 字符集否定匹配，匹配没有在方括号中定义的字符。</p>

<p><code class="highlighter-rouge">^</code>       - 匹配开始位置。</p>

<p><code class="highlighter-rouge">$</code>       - 匹配结束位置。</p>

<p><code class="highlighter-rouge">\(\)</code>    - 定义子表达式。</p>

<p><code class="highlighter-rouge">\n</code>      - 子表达式向前引用，n 为 1-9 之间的数字。 由于此功能已超出正则语义，需</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        要在字符串中回溯，因此需要使用 NFA 算法进行匹配。
</code></pre></div></div>

<p><code class="highlighter-rouge">*</code>       - 任意次匹配（零次或多次匹配）。</p>

<p><code class="highlighter-rouge">\{m,n\}</code> - 至少 m 次，至多 n 次匹配；{m} 表示 m 次精确匹配；{m,} 表示至少 m</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        次匹配。
</code></pre></div></div>

<p><strong>ERE</strong> 修改了 BRE 中的部分语法，并 <strong>增加了以下语法符号</strong>：</p>

<p><code class="highlighter-rouge">?</code>       - 最多一次匹配（零次或一次匹配）。</p>

<p><code class="highlighter-rouge">+</code>       - 至少一次匹配（一次或更多次匹配）。</p>

<p><code class="highlighter-rouge">|</code>       - 或运算，其左右操作数均可以为一个子表达式。</p>

<p>同时，ERE 在使用子表达式 <code class="highlighter-rouge">()</code> 和 次数匹配 <code class="highlighter-rouge">{m,n}</code> 语法符号时，不再需要转义符。 与此同时， ERE 也取消了非正则语义的子表达式向前引用能力。</p>

<p>BRE 和 ERE 共享同样的 <strong>POSIX 字符类定义</strong>。同时，它们还支持 <strong>字符类比较操作</strong> “[. .]” 和字符类等效体 “[= =]” 操作，但很少被使用。</p>

<h3 id="42-用-grep-做范例">4.2 用 GREP 做范例</h3>

<h4 id="421-grep-简介">4.2.1 GREP 简介</h4>

<p>对于给定的模板，grep 会在输入文件中查找匹配的 <strong>行</strong>，如果在某一行中发现了匹配内容，它默认会将该行的内容复制到标准输出，或用户指定的其它输出。</p>

<p>如果输入文件的 <strong>结尾</strong> 不是换行符，grep 会 <strong>自动加上一个换行符</strong>。</p>

<p>因为换行符是分隔符之一，所以无法被匹配。</p>

<h4 id="422-grep-与正则表达式">4.2.2 GREP 与正则表达式</h4>

<h5 id="4221-行与字段锚点">4.2.2.1 行与字段锚点</h5>

<p>锚点是指定义模板时，关键字的位置，如：</p>

<ul>
  <li>行首：<code class="highlighter-rouge">grep ^root /etc/passwd</code></li>
  <li>行尾：<code class="highlighter-rouge">gep :$ /etc/passwd</code></li>
  <li>字段头：<code class="highlighter-rouge">grep '\&lt;PATH' file</code></li>
  <li>字段尾：<code class="highlighter-rouge">grep 'bash\&gt;' file</code></li>
  <li>单独字段：<code class="highlighter-rouge">grep -w / /etc/fstab</code></li>
</ul>

<h5 id="4222-字符类">4.2.2.2 字符类</h5>

<p>一对方括号可以用于定义一个字符列表，用来匹配其中的任意 <strong>单个</strong> 字符。如果列表开头为 <strong><code class="highlighter-rouge">^</code></strong>，表示 <strong>取反</strong>。</p>

<p>如果方括号中的字符列表是一段连续的字符，即某个 <strong>范围</strong> 内的字符，为了简化，可以在首尾两个字符中间使用 <strong><code class="highlighter-rouge">-</code></strong> 来表示，如 <code class="highlighter-rouge">[a-d]</code>。</p>

<h6 id="字典顺序">字典顺序</h6>

<p>但是，<code class="highlighter-rouge">[a-d]</code> 并不一定代表 <code class="highlighter-rouge">[abcd]</code>。</p>

<p>如果系统语系是默认的 C，<code class="highlighter-rouge">[a-d]</code> 是代表 <code class="highlighter-rouge">[abcd]</code>。</p>

<p>但有许多其它语系是按字典顺序来排列字符的，在那些语系中，<code class="highlighter-rouge">[a-d]</code> 代表 <code class="highlighter-rouge">[aBbCcDd]</code>。</p>

<p>因此，如果希望得到预想的结果，建议把 <code class="highlighter-rouge">LC-ALL</code> 变量设置为 <strong><code class="highlighter-rouge">C</code></strong>。</p>

<h5 id="4223-通配符">4.2.2.3 通配符</h5>

<h6><code class="highlighter-rouge">.</code></h6>

<p><code class="highlighter-rouge">.</code> 作为通配符时，用来匹配任意单个字符，因此 <code class="highlighter-rouge">grep '\&lt;c...r\&gt;'</code> 可以匹配 <code class="highlighter-rouge">color</code>。</p>

<p>如果要匹配 <code class="highlighter-rouge">.</code> 本身，即句点，则要使用 <code class="highlighter-rouge">grep -F</code> 选项。</p>

<h6 id="-1"><code class="highlighter-rouge">*</code></h6>

<p><code class="highlighter-rouge">*</code> 作为通配符时，用来匹配多个字符，如 <code class="highlighter-rouge">grep '\&lt;c.*h' .</code> 匹配当前目录中以 <code class="highlighter-rouge">c</code> 开头 <code class="highlighter-rouge">h</code> 结尾的文件名。</p>

<p>如果要匹配 <code class="highlighter-rouge">*</code> 自身，即星号，可以用 <strong>单引号</strong> 将其 <strong>引用</strong>，如 <code class="highlighter-rouge">grep '*' /etc/profile</code>。</p>

<h3 id="43-用-bash-的功能来匹配">4.3 用 bash 的功能来匹配</h3>

<h4 id="431-字符范围">4.3.1 字符范围</h4>

<p>除了 grep 和正则表达式，实际上在 shell 中可以直接使用 <code class="highlighter-rouge">*</code>、<code class="highlighter-rouge">?</code>、<code class="highlighter-rouge">[ ]</code>、<code class="highlighter-rouge">!</code>、<code class="highlighter-rouge">^</code> 这些元字符进行匹配，而无需任何第三方程序。</p>

<p>如果要匹配它们自身，也需要将其 <strong>引用</strong>，如 <code class="highlighter-rouge">'*'</code> 或 <code class="highlighter-rouge">"*"</code> 都可以。</p>

<p>同样可以用 <strong>方括号</strong> 来指定字符范围：<code class="highlighter-rouge">ls -ld [a-cx-z]*</code></p>

<p>用 <code class="highlighter-rouge">!</code> 或 <code class="highlighter-rouge">^</code> 来取反。</p>

<h4 id="432-字符类">4.3.2 字符类</h4>

<p>方括号中还以指定字符类，语法为 <code class="highlighter-rouge">[:CLASS:]</code>，其中 <code class="highlighter-rouge">CLASS</code> 是 POSIX 定义的标准，主要有以下值：</p>

<p>[:alnum:]  字母数字</p>

<p>[:alpha:]  字母</p>

<p>[:ascii:]  ASCII 字符</p>

<p>[:blank:]  空格与制表符</p>

<p>[:cntrl:]  控制字符</p>

<p>[:digit:]  数字</p>

<p>[:graph:]  可见字符（非空白、非控制字符）</p>

<p>[:lower:]  小写字母</p>

<p>[:print:]  可见字符与空格</p>

<p>[:punct:]  标点</p>

<p>[:space:]  所有空白字符（换行符、空格、制表符）</p>

<p>[:upper:]  大写字母</p>

<p>[:word:]  字母、数字、下划线</p>

<p>[:xdigit:]  十六进制数字</p>

<p>如果 shell 的 <code class="highlighter-rouge">extglob</code> 选项被启用，还可以使用其它几个扩展的操作符。</p>

<h2 id="5-sed">5. SED</h2>

<p>GDN sed 流编辑器。</p>

<h3 id="51-sed-简介">5.1 SED 简介</h3>

<p>SED，<strong>S</strong>tream <strong>ED</strong>itor，<strong>流编辑器</strong> 用于把从文件或管道读取的文本进行一些基本的转换，转换的结果被发送给 <strong>基本输出</strong>。SED <strong>不会直接修改原始文件</strong>，可以用重定向将修改结果另存为文件。</p>

<p>sed 与 <code class="highlighter-rouge">vi</code> 等编辑器的区别在于，它可以 <strong>过滤</strong> 来自于管道的文本。你无需与其交互，因此 sed 又被称为批处理编辑器。它允许把多个文本编辑的命令保存到脚本中，大大简化了重复的编辑任务。它可以在大量文件中进行 <strong>批量的文本替换</strong>。</p>

<h4 id="sed-命令">sed 命令</h4>

<p><code class="highlighter-rouge">sed</code> 程序可以使用正则表达式，进行文本的 <strong>替换</strong> 和 <strong>删除</strong>。</p>

<p><strong><code class="highlighter-rouge">sed SCRIPT INPUTFILE</code></strong></p>

<h5 id="sed-编辑命令">sed 编辑命令</h5>

<p>其编辑文本的命令与 <code class="highlighter-rouge">vi</code> 有些类似：</p>

<table>
  <thead>
    <tr>
      <th>命令</th>
      <th>作用</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">a\</code></td>
      <td>在当前行下面追加文本</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">c\</code></td>
      <td>修改当前行文本</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">d</code></td>
      <td>删除匹配行</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">i\</code></td>
      <td>在当前行上面插入文本</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">p</code></td>
      <td>打印匹配行</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">r</code></td>
      <td>读取文件</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">s</code></td>
      <td>查找并替换文本</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">w</code></td>
      <td>写入文件</td>
    </tr>
  </tbody>
</table>

<h5 id="sed-选项">sed 选项</h5>

<table>
  <thead>
    <tr>
      <th>选项</th>
      <th>作用</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">-e SCRIPT</code></td>
      <td>用 <strong>脚本</strong> 来处理输入</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">-f</code></td>
      <td>用 <strong>脚本文件</strong> 中的命令来处理输入</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">-n</code></td>
      <td>不打印原文件</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">-V</code></td>
      <td>查看 sed 版本</td>
    </tr>
  </tbody>
</table>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-e</span> <span class="s1">'/^foo/d'</span> <span class="nt">-f</span> script2.sed input.txt <span class="o">&gt;</span> output.txt
</code></pre></div></div>

<h3 id="52-交互式编辑">5.2 交互式编辑</h3>

<h4 id="521-打印匹配行">5.2.1 打印匹配行</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-n</span> <span class="s1">'/erors/p'</span> example
</code></pre></div></div>

<p><code class="highlighter-rouge">-n</code> 确保不打印全部原文</p>

<p><code class="highlighter-rouge">p</code> 打印匹配行</p>

<h4 id="522-删除匹配行">5.2.2 删除匹配行</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="s1">'/erors/d'</span> example
</code></pre></div></div>

<p><code class="highlighter-rouge">d</code> 删除匹配行。即 <strong>取反</strong>，打印不匹配的行。</p>

<h4 id="523-根据行号限定行">5.2.3 根据行号限定行</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="s1">'2,4d'</span> example
</code></pre></div></div>

<p>删除第 2 行 ~ 第 4 行。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="s1">'3,$d'</span> example
</code></pre></div></div>

<p>删除第 3 行到末行，即仅保留前 2 行。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-n</span> <span class="s1">'/a text/,/This/p'</span> example
</code></pre></div></div>

<p>匹配的起始行为 <code class="highlighter-rouge">a text</code> 所在行，结束行为 <code class="highlighter-rouge">This</code> 所在行。</p>

<h4 id="524-查找并替换">5.2.4 查找并替换</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="s1">'s/erors/errors/'</span> example
</code></pre></div></div>

<p>查找 <code class="highlighter-rouge">erors</code>，替换为 <code class="highlighter-rouge">errors</code>，但仅针对每行找到的 <strong>第一个</strong> 字段。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="s1">'s/erors/errors/g'</span> example
</code></pre></div></div>

<p>查找替换所有字段。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="s1">'s/^/&gt; /'</span> example
</code></pre></div></div>

<p>在每行开头插入 <code class="highlighter-rouge">&gt; </code>。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="s1">'s/$/EOL/'</span> example
</code></pre></div></div>

<p>在每行结尾插入 <code class="highlighter-rouge">EOL</code>。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-e</span> <span class="s1">'s/erors/errors/g'</span> <span class="nt">-e</span> <span class="s1">'s/last/final/g'</span> example
</code></pre></div></div>

<p>同时进行多个查找与替换。</p>

<h3 id="53-非交互式编辑">5.3 非交互式编辑</h3>

<h4 id="531-从文件中读取-sed-命令">5.3.1 从文件中读取 sed 命令</h4>

<p>可以把多个 sed 命令写入文件，然后用 <code class="highlighter-rouge">sed -f file.sed</code> 选项来执行。创建 sed 文件时，要确保：</p>

<ul>
  <li>每行结尾不能有空白</li>
  <li>不能使用引用</li>
  <li>如果要插入或替换文本，除最后一行外，每行要以反斜线 <code class="highlighter-rouge">\</code> 结束</li>
</ul>

<h4 id="532-输出文件另存为">5.3.2 输出文件另存为</h4>

<p>需要借助输出重定向操作系统 <code class="highlighter-rouge">&gt;</code> 来把输出另存为文件。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">SCRIPT</span><span class="o">=</span><span class="s2">"/home/sandy/scripts/script.sed"</span>
<span class="nv">NAME</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
<span class="nv">TEMPFILE</span><span class="o">=</span><span class="s2">"/var/tmp/sed.</span><span class="nv">$PID</span><span class="s2">.tmp"</span>
<span class="nb">sed</span> <span class="s2">"s/</span><span class="se">\n</span><span class="s2">/^M/"</span> <span class="nv">$1</span> | <span class="nb">sed</span> <span class="nt">-f</span> <span class="nv">$SCRIPT</span> | <span class="nb">sed</span> <span class="s2">"s/^M/</span><span class="se">\n</span><span class="s2">/"</span> <span class="o">&gt;</span> <span class="nv">$TEMPFILE</span>
<span class="nb">mv</span> <span class="nv">$TEMPFILE</span> <span class="nv">$NAME</span>
</code></pre></div></div>

<h2 id="6-awk">6. AWK</h2>

<h3 id="61-从-gawk-开始">6.1 从 gawk 开始</h3>

<h4 id="611-gawk-是什么">6.1.1 gawk 是什么</h4>

<p><code class="highlighter-rouge">awk</code> 是一个 UNIX 程序，而 <code class="highlighter-rouge">gawk</code> 是其常用的 GNU 版本，它是另一个流编辑器。实际上 <code class="highlighter-rouge">awk</code> 程序通常是 <code class="highlighter-rouge">gawk</code> 的符号链接。</p>

<p><code class="highlighter-rouge">awk</code> 的基本功能是按照 <strong>一个或多个模板</strong>，查找文件的匹配 <strong>行</strong> 或 <strong>其它匹配单位</strong>，可以针对匹配行进行特殊的操作。</p>

<p>通常的程序是 “程序化” 的，需要在程序中详细描述每一步它应该做什么，很难清楚地表达程序要处理的数据。</p>

<p class="notice--info">而 <code class="highlighter-rouge">awk</code> 中的众多程序比较特别，它们是 “<strong>数据驱动</strong>” 的，你可以先描述要处理的 <strong>数据是什么样的</strong>，然后告诉程序找到这些数据以后要 <strong>做什么</strong>*。</p>

<h4 id="612-gawk-命令">6.1.2 gawk 命令</h4>

<p>运行 <code class="highlighter-rouge">awk</code> 时，需要指定一个 <code class="highlighter-rouge">awk</code> 程序来 <strong>处理匹配数据</strong>。该程序由一系列规则组成，其中可以包含函数定义、循环、条件等编程组件。每条规则指定 <strong>一个模板</strong> 用来查找，<strong>一个动作</strong> 用来处理匹配。</p>

<p><code class="highlighter-rouge">awk</code> 有多种运行方式，通常使用 <code class="highlighter-rouge">awk PROGRAM inputfile(s)</code> 格式。</p>

<p>如果要对多个文件、进行多种修改，最好把 <code class="highlighter-rouge">awk</code> 命令写入脚本文件，以如下方式运行：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">awk</span> <span class="nt">-f</span> PROGRAM-FILE inputfile<span class="o">(</span>s<span class="o">)</span>
</code></pre></div></div>

<h3 id="62-print-程序">6.2 <code class="highlighter-rouge">print</code> 程序</h3>

<h4 id="621-打印所选字段">6.2.1 打印所选字段</h4>

<p><code class="highlighter-rouge">awk</code> 的 <code class="highlighter-rouge">print</code> 命令用于将所选数据打印出来。</p>

<p><code class="highlighter-rouge">awk</code> 从文件中读取一行时，会基于字段分隔符（FS）将该行分割成字段。<code class="highlighter-rouge">FS</code> 是一个 <code class="highlighter-rouge">awk</code> 的变量，默认为一个或多个空白字符。</p>

<p>变量 <code class="highlighter-rouge">$1</code>、<code class="highlighter-rouge">$2</code>、<code class="highlighter-rouge">$3</code>、<code class="highlighter-rouge">$4</code> 等用于保存分割后的每个字段的值，<code class="highlighter-rouge">$0</code> 用于保存整行的内容。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> <span class="nt">-l</span> | <span class="nb">awk</span> <span class="s1">'{ print $5 "\t" $9 }'</span>
</code></pre></div></div>

<h4 id="622-格式化字段">6.2.2 格式化字段</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> <span class="nt">-ldh</span> <span class="k">*</span> | <span class="nb">grep</span> <span class="nt">-v</span> total | <span class="se">\</span>
<span class="nb">awk</span> <span class="s1">'{ print "Size is " $5 " bytes for " $9 }'</span>
</code></pre></div></div>

<p>要想让  <code class="highlighter-rouge">awk</code> 的输出更加易于阅读，还是需要人为地为格式化做些努力。如在适当的位置插入一些文字说明、空格、制表符等。</p>

<p>需要时还可以使用 <code class="highlighter-rouge">sort</code>、<code class="highlighter-rouge">head</code>、<code class="highlighter-rouge">tail</code> 等来排序、截取。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">df</span> <span class="nt">-h</span> | <span class="nb">sort</span> <span class="nt">-rnk</span> 5 | <span class="nb">head</span> <span class="nt">-3</span> | <span class="se">\</span>
<span class="nb">awk</span> <span class="s1">'{ print "Partition " $6 "\t: " $5 " used." }'</span>
</code></pre></div></div>

<h5 id="特殊格式化字符">特殊格式化字符</h5>

<table>
  <thead>
    <tr>
      <th>字符</th>
      <th>作用</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">\a</code></td>
      <td>提示音</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\n</code></td>
      <td>换行符</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\t</code></td>
      <td>制表符</td>
    </tr>
  </tbody>
</table>

<h4 id="623-print-命令与正则表达式">6.2.3 <code class="highlighter-rouge">print</code> 命令与正则表达式</h4>

<p>把正则表达式放到一对斜线中，可以用来做模板来匹配。</p>

<p><code class="highlighter-rouge">awk 'EXPRESSION { PROGRAM }' file(s)</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">df</span> <span class="nt">-h</span> | <span class="nb">awk</span> <span class="s1">'/dev\/hd/ { print $6 "\t: " $5 }'</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">/dev\/hd/</code> 表达式中的斜线必须转义。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> <span class="nt">-l</span> | <span class="nb">awk</span> <span class="s1">'/\&lt;(a|x).*\.conf$/ { print $9 }'</span>
</code></pre></div></div>

<p>匹配以 a 或 x 开头的 <code class="highlighter-rouge">.conf</code> 文件。表达式中第一个 <code class="highlighter-rouge">.</code> 为通配符，第二个 <code class="highlighter-rouge">.</code> 为句点本身，所以被转义。</p>

<h4 id="624-在输出中添加注释">6.2.4 在输出中添加注释</h4>

<p>要想在输出的前面或后面添加注释，需要使用 <code class="highlighter-rouge">BEGIN</code> 或 <code class="highlighter-rouge">END</code> 来标记：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> <span class="nt">-l</span> | <span class="se">\</span>
<span class="nb">awk</span> <span class="s1">'BEGIN { print "Files found:\n" } /\&lt;[a|x].*\.conf$/ { print $9 }'</span>

<span class="nb">ls</span> <span class="nt">-l</span> | <span class="se">\</span>
<span class="nb">awk</span> <span class="s1">'/\&lt;[a|x].*\.conf$/ { print $9 } END { print \
"these files are found." }'</span>
</code></pre></div></div>

<h4 id="625-gawk-脚本">6.2.5 gawk 脚本</h4>

<p>把 <code class="highlighter-rouge">awk</code> 命令写入脚本文件，以便重用。<code class="highlighter-rouge">awk</code> 脚本可以包含 <code class="highlighter-rouge">awk</code> <strong>声明</strong>，通过声明来 <strong>定义模板和动作</strong>。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat diskrep.awk
BEGIN { print "*** WARNING WARNING WARNING ***" }
/\&lt;[8|9][0-9]%/ { print "Partition " $6 "\t: " $5 " full!" }
END { print "*** Give money for new disks URGENTLY! ***" }
</code></pre></div></div>

<p>匹配 <code class="highlighter-rouge">80% ~ 99%</code> 。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">df</span> <span class="nt">-h</span> | <span class="nb">awk</span> <span class="nt">-f</span> diskrep.awk
<span class="k">***</span> WARNING WARNING WARNING <span class="k">***</span>
Partition /usr  : 97% full!
<span class="k">***</span> Give money <span class="k">for </span>new disks URGENTLY! <span class="k">***</span>
</code></pre></div></div>

<h3 id="63-gawk-变量">6.3 gawk 变量</h3>

<p><code class="highlighter-rouge">awk</code> 处理输入文件时，要用到几个变量，其中有的是可修改的，有的是只读的。</p>

<h4 id="631-输入字段分隔符">6.3.1 输入字段分隔符</h4>

<p>Field Separator，FS</p>

<p>字段分隔符可以是单个字符，也可以是一个正则表达式，用来控制 <code class="highlighter-rouge">awk</code> 如何把输入分割成字段。</p>

<p class="notice--info">字段分隔符用内建变量 <code class="highlighter-rouge">FS</code> 表示，注意，它与兼容 POSIX 的 shell 所使用的 <code class="highlighter-rouge">IFS</code> 变量不是一回事。</p>

<p>字段分隔符的值可以用 <code class="highlighter-rouge">=</code> 来修改。通常对它的定义需要在 <code class="highlighter-rouge">BEGIN</code> 模板中进行：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">awk</span> <span class="s1">'BEGIN { FS=":" } { print $1 "\t" $5 }'</span> /etc/passwd
</code></pre></div></div>

<p>如果写到脚本中：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat printnames.awk
BEGIN { FS=":" }
{ print $1 "\t" $5 }

$ awk -f printnames.awk /etc/passwd
</code></pre></div></div>

<p>定义分隔符时一定要小心，否则容易出问题。</p>

<h4 id="632-输出分隔符">6.3.2 输出分隔符</h4>

<h5 id="6321-输出字段分隔符">6.3.2.1 输出字段分隔符</h5>

<p>Output Field Separator，OFS，也是内建变量。通常为空格。</p>

<p>输出的字段通常用空格分隔，但只有在用逗号来分隔 <code class="highlighter-rouge">print</code> 的参数时才会使用：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat test
</span>record1         data1
record2         data2

<span class="nv">$ </span><span class="nb">awk</span> <span class="s1">'{ print $1 $2}'</span> <span class="nb">test</span>
<span class="c">#      参数  $1 和 $2 之间没有逗号</span>
record1data1
record2data2
<span class="c">#  输出就不会用空格，而是把 $1$2 做为一个参数</span>
<span class="c">#  所以它们的输出是连在一起的</span>

<span class="nv">$ </span><span class="nb">awk</span> <span class="s1">'{ print $1, $2}'</span> <span class="nb">test</span>
<span class="c">#                ^  有逗号分隔</span>
record1 data1
record2 data2
<span class="c"># 所以 $1 和 $2 被当作两个参数对待</span>
<span class="c"># 在它们的输出之间自动添加空格</span>
</code></pre></div></div>

<h5 id="6322-输出记录分隔符">6.3.2.2 输出记录分隔符</h5>

<p>Output Record Separator，ORS，内建变量。</p>

<p>一条 <code class="highlighter-rouge">print</code> 语句的整体输出称为一条输出记录。每个 <code class="highlighter-rouge">print</code> 命令都会产生一个输出记录，其后跟着一个字符串，即 ORS。该变量的默认值为换行符 <code class="highlighter-rouge">\n</code>，因此，每条 <code class="highlighter-rouge">print</code> 语句才会产生一个单独的行。</p>

<p>要想修改分割输出字段和输出记录的方式，可以通过为 <code class="highlighter-rouge">OFS</code> 和 <code class="highlighter-rouge">ORS</code> 变量赋值：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">awk</span> <span class="s1">'BEGIN { OFS=";" ; ORS="\n--&gt;\n" } \
	{ print $1,$2}'</span> <span class="nb">test
</span>record1<span class="p">;</span>data1
<span class="nt">--</span><span class="o">&gt;</span>
record2<span class="p">;</span>data2
<span class="nt">--</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>如果 <code class="highlighter-rouge">ORS</code> 中没有换行符，全部输入就会变成一行。</p>

<h4 id="633-记录数">6.3.3 记录数</h4>

<p>Number of Records，NR，内建变量。</p>

<p>该变量用于保存 <code class="highlighter-rouge">awk</code> 处理的记录数量。每读取一行新的输入，就会加 1。可以在脚本结尾处，用来统计记录总数。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat processed.awk
BEGIN { OFS="-" ; ORS="\n--&gt; done\n" }
{ print "Record number " NR ":\t" $1,$2 }
END { print "Number of records processed: " NR }
</code></pre></div></div>

<h4 id="634-自定义变量">6.3.4 自定义变量</h4>

<p>除了内建变量，用户可以根据需要来自定义自己的变量。</p>

<p>如果 <code class="highlighter-rouge">awk</code> 遇到对一个新变量的引用，如果该变量之前没有定义，则会立即创建，并为其赋空值。</p>

<p>可以用 <code class="highlighter-rouge">=</code> 为变量赋值。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat revenues
20021009        20021013        consultancy     BigComp         2500
20021015        20021020        training        EduComp         2000
20021112        20021123        appdev          SmartComp       10000
20021204        20021215        training        EduComp         5000

$ cat total.awk
{ total=total + $5 }
{ print "Send bill for " $5 " dollar to " $4 }
END { print "---------------------------------\nTotal revenue: " total }

$ awk -f total.awk test
Send bill for 2500 dollar to BigComp
Send bill for 2000 dollar to EduComp
Send bill for 10000 dollar to SmartComp
Send bill for 5000 dollar to EduComp
---------------------------------
Total revenue: 19500
</code></pre></div></div>

<p>也支持使用 <code class="highlighter-rouge">VAR+= value</code> 的自增格式。</p>

<h4 id="635-printf-命令">6.3.5 <code class="highlighter-rouge">printf</code> 命令</h4>

<p>要想达到更加精确地格式化，可以使用 <code class="highlighter-rouge">printf</code> 命令。</p>

<p>它可以针对每一个具体的字段进行个性化的格式设定。</p>

<h2 id="7-条件语句">7. 条件语句</h2>

<h3 id="71-if-简介">7.1 <code class="highlighter-rouge">if</code> 简介</h3>

<h4 id="711-if-的一般用法">7.1.1 <code class="highlighter-rouge">if</code> 的一般用法</h4>

<p>根据某命令的运行结果来进行下一个操作。</p>

<p><code class="highlighter-rouge">if TEST-COMMANDS; then CONSEQUENT-COMMANDS; fi</code></p>

<p>如果 <code class="highlighter-rouge">TEST-COMMANDS</code> 运行后返回的状态为 0，则会执行 <code class="highlighter-rouge">CONSEQUENT-COMMANDS</code> 中的命令。</p>

<p><code class="highlighter-rouge">CONSEQUENT-COMMANDS</code> 经常会涉及到对数字或字符串的比较，当然也可以是任何其它命令。</p>

<p>通常用 <strong>一元表达式</strong> 来检查文件的状态，如果被检查的文件参数为 <code class="highlighter-rouge">/dev/fd/N</code> 形式，则会检查文件描述符 N。</p>

<p>标准输入、标准输出、标准错误及它们对应的描述符也可以用来测试。</p>

<h5 id="7111-常用的-if-表达式">7.1.1.1 常用的 <code class="highlighter-rouge">if</code> 表达式</h5>

<p><code class="highlighter-rouge">TEST-COMMANDS</code> 如果是条件测试，则需要用中括号 <code class="highlighter-rouge">[ expressions ]</code> 把表达式括起来。</p>

<p>针对文件的条件测试：</p>

<table>
  <thead>
    <tr>
      <th>表达式</th>
      <th>为 <code class="highlighter-rouge">真</code> 的测试结果</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">[ -a FILE ]</code></td>
      <td>文件存在</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -b FILE ]</code></td>
      <td>文件存在，为块设备</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -c FILE ]</code></td>
      <td>文件存在，为字符设备</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -d FILE ]</code></td>
      <td>文件存在，为目录</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -e FILE ]</code></td>
      <td>文件存在</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -f FILE ]</code></td>
      <td>文件存在，普通文件</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -g FILE ]</code></td>
      <td>文件存在，SGID 位被设置</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -h FILE ]</code></td>
      <td>文件存在，符号链接</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -k FILE ]</code></td>
      <td>文件存在，SBIT 位被设置</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -p FILE ]</code></td>
      <td>文件存在，FIFO 文件</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -r FILE ]</code></td>
      <td>文件存在，可读</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -s FILE ]</code></td>
      <td>文件存在，大小大于零</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -t FD ]</code></td>
      <td>文件描述符被打开，指代某终端</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -u FILE ]</code></td>
      <td>文件存在，SUID 位被设置</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -w FILE ]</code></td>
      <td>文件存在，可写</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -x FILE ]</code></td>
      <td>文件存在，可执行</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -O FILE ]</code></td>
      <td>文件存在，所有者为 EUID</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -G FILE ]</code></td>
      <td>文件存在，所有者为 EGID</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -L FILE ]</code></td>
      <td>文件存在，符号链接</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -N FILE ]</code></td>
      <td>文件存在，最近读取后被修改过</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -S FILE ]</code></td>
      <td>文件存在，套接字</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ FILE1 -nt FILE2 ]</code></td>
      <td><code class="highlighter-rouge">FILE1</code> 的修改时间比 <code class="highlighter-rouge">FILE2</code> 新，或 <code class="highlighter-rouge">FILE1</code> 存在而 <code class="highlighter-rouge">FILE2</code> 不存在</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ FILE1 -ot FILE2 ]</code></td>
      <td><code class="highlighter-rouge">FILE1</code> 的修改时间比 <code class="highlighter-rouge">FILE2</code> 旧，或 <code class="highlighter-rouge">FILE2</code> 存在而 <code class="highlighter-rouge">FILE1</code> 不存在</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ FILE1 -ef FILE2 ]</code></td>
      <td><code class="highlighter-rouge">FILE1</code> 和 <code class="highlighter-rouge">FILE2</code> 指向同一个设备、同一个 inode 编号</td>
    </tr>
  </tbody>
</table>

<p>针对选项、字符串、参数的条件测试：</p>

<table>
  <thead>
    <tr>
      <th>表达式</th>
      <th>为 <code class="highlighter-rouge">真</code> 的测试结果</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">[ -o OPTIONNAME ]</code></td>
      <td>shell 的 <code class="highlighter-rouge">OPTIONNAME</code> 选项已启用</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -z STRING ]</code></td>
      <td><code class="highlighter-rouge">STRING</code> 字符串的长度为 0</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ -n STRING ] or [ STRING ]</code></td>
      <td><code class="highlighter-rouge">STRING</code> 字符串的长度不是 0</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ STRING1 == STRING2 ]</code></td>
      <td>两个字符串相同。<code class="highlighter-rouge">==</code> 可用 <code class="highlighter-rouge">=</code> 代替</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ STRING1 != STRING2 ]</code></td>
      <td>两个字符串不同</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ STRING1 &lt; STRING2 ]</code></td>
      <td>在当前语系中，<code class="highlighter-rouge">STRING1</code> 排序在 <code class="highlighter-rouge">STRING2</code> 的前面</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ STRING1 &gt; STRING2 ]</code></td>
      <td>在当前语系中，<code class="highlighter-rouge">STRING1</code> 排序在 <code class="highlighter-rouge">STRING2</code> 的后面</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ ARG1 OP ARG2 ]</code></td>
      <td><code class="highlighter-rouge">OP</code> 代表操作符，可以是 <code class="highlighter-rouge">-eq</code>、<code class="highlighter-rouge">-ne</code>、<code class="highlighter-rouge">-lt</code>、<code class="highlighter-rouge">-le</code>、<code class="highlighter-rouge">-gt</code>、<code class="highlighter-rouge">-ge</code> 之一。</td>
    </tr>
  </tbody>
</table>

<p>可以用以下操作符来组合表达式：</p>

<table>
  <thead>
    <tr>
      <th>表达式</th>
      <th>为 <code class="highlighter-rouge">真</code> 的测试结果</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">[ ! EXPR ]</code></td>
      <td><code class="highlighter-rouge">EXPR</code> 为假</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ ( EXPR ) ]</code></td>
      <td>返回 <code class="highlighter-rouge">EXPR</code> 的值，用于覆盖操作符的普通优先级</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ EXPR1 -a EXPR2 ]	</code></td>
      <td><code class="highlighter-rouge">EXPR1</code> 和 <code class="highlighter-rouge">EXPR2</code> 均为真</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">[ EXPR1 -o EXPR2 ]</code></td>
      <td><code class="highlighter-rouge">EXPR1</code> 或 <code class="highlighter-rouge">EXPR2</code> 为真</td>
    </tr>
  </tbody>
</table>

<p>这种 <code class="highlighter-rouge">[ ... ]</code> 格式，或 <code class="highlighter-rouge">test</code> 内建命令可以对条件表达式进行测试。</p>

<h5 id="7112-then-后面的命令">7.1.1.2 <code class="highlighter-rouge">then</code> 后面的命令</h5>

<p><code class="highlighter-rouge">then</code> 后面的 <code class="highlighter-rouge">CONSEQUENT-COMMANDS</code> 可以是任何有效的 UNIX 命令、可执行程序、可执行脚本、shell 语句，当然除了 <code class="highlighter-rouge">fi</code>。</p>

<p class="notice--info">一定要记住，<code class="highlighter-rouge">then</code> 和 <code class="highlighter-rouge">fi</code> 在 shell 中被当作单独的语句，因此，如果在命令行中同一行使用时，它们之间必须用分号 <code class="highlighter-rouge">;</code> 来分隔。</p>

<p>在脚本中，<code class="highlighter-rouge">if</code> 语句的不同部分通常可以自动分隔。</p>

<h5 id="7113-检测文件">7.1.1.3 检测文件</h5>

<p>检测文件是否存在：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="k">if</span> <span class="o">[</span> <span class="nt">-f</span> /var/log/messages <span class="o">]</span>
  <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"/var/log/messages exists."</span>
<span class="k">fi</span>
</code></pre></div></div>

<h5 id="7114-检测-shell-选项">7.1.1.4 检测 shell 选项</h5>

<p>可以在启动脚本中添加：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="o">[</span> <span class="nt">-o</span> noclobber <span class="o">]</span>
  <span class="k">then
	</span><span class="nb">echo</span> <span class="s2">"Your files are protected against accidental overwriting using redirection."</span>
<span class="k">fi</span>
</code></pre></div></div>

<h4 id="712-if-的常见应用">7.1.2 <code class="highlighter-rouge">if</code> 的常见应用</h4>

<h5 id="7121-测试退出状态">7.1.2.1 测试退出状态</h5>

<p><code class="highlighter-rouge">?</code> 变量会保存上一个前台命令的退出状态。</p>

<p>直接测试 <code class="highlighter-rouge">?</code> 的值：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>grep $USER /etc/passwd
if [ $? -eq 0 ]
</code></pre></div></div>

<p>用表达式测试：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if ! grep $USER /etc/passwd
</code></pre></div></div>

<h5 id="7122-数字的比较">7.1.2.2 数字的比较</h5>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if [ "$num" -gt "150"
</code></pre></div></div>

<h5 id="7123-字符串比较">7.1.2.3 字符串比较</h5>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if [ "$(whoami)" != 'root' ]; then
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[ "$(whoami)" != 'root' ] &amp;&amp; ( echo you are using a non-privileged account; exit 1 )
</code></pre></div></div>

<p>比较语句中也可以使用正则表达式：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if [[ "$gender" == f* ]]
</code></pre></div></div>

<p>👉 <code class="highlighter-rouge">test</code> 命令</p>

<p>大部分程序员更喜欢用 <code class="highlighter-rouge">test</code> 内建命令来进行测试，其效果与方括号是一样的：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>test "$(whoami)" != 'root' &amp;&amp; (echo you are using a non-privileged account; exit 1)
</code></pre></div></div>

<p>👉 不能用 <code class="highlighter-rouge">exit</code></p>

<p>因为在子 shell 中调用 <code class="highlighter-rouge">exit</code> 会导致无法传递变量。</p>

<p>因此，如果不希望 bash 产生子 shell，可以用 <code class="highlighter-rouge">{ }</code>，而不用 <code class="highlighter-rouge">( )</code>。</p>

<h3 id="72-if-高级应用">7.2 <code class="highlighter-rouge">if</code> 高级应用</h3>

<h4 id="721-if--then--else-结构">7.2.1 <code class="highlighter-rouge">if / then / else</code> 结构</h4>

<h5 id="7211-范例">7.2.1.1 范例</h5>

<p>该结构可以根据不同的测试结果，分别进行不同的操作。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="o">[[</span> <span class="s2">"</span><span class="nv">$gender</span><span class="s2">"</span> <span class="o">==</span> <span class="s2">"f*"</span> <span class="o">]]</span>
<span class="k">then </span><span class="nb">echo</span> <span class="s2">"Pleasure to meet you, Madame."</span>
<span class="k">else </span><span class="nb">echo</span> <span class="s2">"How come the lady hasn't got a drink yet?"</span>
<span class="k">fi</span>
</code></pre></div></div>

<p>单层方括号与双层方括号的区别：</p>

<p>双层 <code class="highlighter-rouge">[[  ]]</code> 可以防止变量值被执行 <strong>字段分割</strong>，还可以防止 <strong>路径扩展</strong>。</p>

<h5 id="7212-检测命令行参数">7.2.1.2 检测命令行参数</h5>

<p>在命令行中为变量赋值，比从脚本中赋值来的更加优雅。</p>

<p>通常使用位置参数 <code class="highlighter-rouge">$1</code>、<code class="highlighter-rouge">$2</code> 等来完成，<code class="highlighter-rouge">$#</code> 表示命令行参数的总数，<code class="highlighter-rouge">$0</code> 表示脚本名称。</p>

<p>例脚本内容为：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">weight</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
<span class="nv">height</span><span class="o">=</span><span class="s2">"</span><span class="nv">$2</span><span class="s2">"</span>
<span class="nv">idealweight</span><span class="o">=</span><span class="nv">$[$height</span> - 110]

<span class="k">if</span> <span class="o">[</span> <span class="nv">$weight</span> <span class="nt">-le</span> <span class="nv">$idealweight</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s2">"You should eat a bit more fat."</span>
<span class="k">else
  </span><span class="nb">echo</span> <span class="s2">"You should eat a bit more fruit."</span>
<span class="k">fi</span>
</code></pre></div></div>

<p>调用脚本：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bash <span class="nt">-x</span> weight.sh 55 169
</code></pre></div></div>

<h5 id="7213-测试参数的数量">7.2.1.3 测试参数的数量</h5>

<p><code class="highlighter-rouge">$#</code> 表示命令行参数的总数。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="o">[</span> <span class="o">!</span> <span class="nv">$# </span><span class="o">==</span> 2 <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s2">"Usage: </span><span class="nv">$0</span><span class="s2"> weight_in_kilos length_in_centimeters"</span>
  <span class="nb">exit
</span><span class="k">fi</span>
</code></pre></div></div>

<h5 id="7214-测试文件是否存在">7.2.1.4 测试文件是否存在</h5>

<p>许多脚本中经常用到这个测试。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="nv">FILENAME</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>

<span class="nb">echo</span> <span class="s2">"Properties for </span><span class="nv">$FILENAME</span><span class="s2">:"</span>

<span class="k">if</span> <span class="o">[[</span> <span class="nt">-f</span> <span class="nv">$FILENAME</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s2">"Size is </span><span class="k">$(</span><span class="nb">ls</span> <span class="nt">-lh</span> <span class="nv">$FILENAME</span> | <span class="nb">awk</span> <span class="s1">'{ print $5 }'</span><span class="k">)</span><span class="s2">"</span>
  <span class="nb">echo</span> <span class="s2">"Type is </span><span class="k">$(</span>file <span class="nv">$FILENAME</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s2">":"</span> <span class="nt">-f2</span> -<span class="k">)</span><span class="s2">"</span>
  <span class="nb">echo</span> <span class="s2">"Inode number is </span><span class="k">$(</span><span class="nb">ls</span> <span class="nt">-i</span> <span class="nv">$FILENAME</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s2">" "</span> <span class="nt">-f1</span> -<span class="k">)</span><span class="s2">"</span>
  <span class="nb">echo</span> <span class="s2">"</span><span class="k">$(</span><span class="nb">df</span> <span class="nt">-h</span> <span class="nv">$FILENAME</span> | <span class="nb">grep</span> <span class="nt">-v</span> Mounted | <span class="nb">awk</span> <span class="s1">'{ print "On",$1", \
which is mounted as the",$6,"partition."}'</span><span class="k">)</span><span class="s2">"</span>
<span class="k">else
  </span><span class="nb">echo</span> <span class="s2">"File does not exist."</span>
<span class="k">fi</span>
</code></pre></div></div>

<h4 id="722-if--then--elif--else-结构">7.2.2 <code class="highlighter-rouge">if / then / elif / else</code> 结构</h4>

<p>基本结构：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if </span>TEST-COMMANDS<span class="p">;</span> <span class="k">then
	</span>CONSEQUENT-COMMANDS<span class="p">;</span>
<span class="k">elif </span>MORE-TEST-COMMANDS<span class="p">;</span> <span class="k">then
	</span>MORE-CONSEQUENT-COMMANDS<span class="p">;</span>
<span class="k">else </span>ALTERNATE-CONSEQUENT-COMMANDS<span class="p">;</span>
<span class="k">fi</span>
</code></pre></div></div>

<h4 id="723-if-语句的嵌套">7.2.3 <code class="highlighter-rouge">if</code> 语句的嵌套</h4>

<p><code class="highlighter-rouge">if</code> 可以嵌套多层 <code class="highlighter-rouge">if</code>。</p>

<h4 id="724-布尔运算">7.2.4 布尔运算</h4>

<p>如果条件很复杂，可以用布尔运算符来连接多个条件：</p>

<p><code class="highlighter-rouge">&amp;&amp;</code> ：表示 <strong>与</strong></p>

<p><code class="highlighter-rouge">||</code> ：表示 <strong>或</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="nv">year</span><span class="o">=</span><span class="sb">`</span><span class="nb">date</span> +%Y<span class="sb">`</span>

<span class="k">if</span> <span class="o">((</span> <span class="o">(</span><span class="s2">"</span><span class="nv">$year</span><span class="s2">"</span> % 400<span class="o">)</span> <span class="o">==</span> <span class="s2">"0"</span> <span class="o">))</span> <span class="o">||</span> <span class="o">((</span> <span class="o">(</span><span class="s2">"</span><span class="nv">$year</span><span class="s2"> % 4 == "</span>0<span class="s2">") &amp;&amp; ("</span><span class="nv">$year</span><span class="s2">" % 100 != "</span>0<span class="s2">") )); then
	echo "</span>leap year<span class="s2">"
else
	echo "</span>not leap year<span class="s2">"
fi
</span></code></pre></div></div>

<h4 id="725-exit-语句">7.2.5 <code class="highlighter-rouge">exit</code> 语句</h4>

<p><code class="highlighter-rouge">exit</code> 语句会终止脚本的执行，经常用于用户发来的输入请求有误时，或某个语句没有成功运行，或发生其它错误时。</p>

<p><code class="highlighter-rouge">exit</code> 可以接一个参数，该参数必须是整数，代表退出状态码，它会被传递给父进程，并保存到 <code class="highlighter-rouge">$?</code> 变量中。</p>

<p><code class="highlighter-rouge">exit 0</code> 表示脚本运行成功，任何其他值都用于针对不同的错误进行不同的操作。如果 <code class="highlighter-rouge">exit</code> 命令没有跟参数，父 shell 会使用 <code class="highlighter-rouge">$?</code> 变量的当前值。</p>

<h3 id="73-case-语句">7.3 <code class="highlighter-rouge">case</code> 语句</h3>

<h4 id="731-简化条件">7.3.1 简化条件</h4>

<p>虽然可以使用嵌套的 <code class="highlighter-rouge">if</code> 语句，但如果不同的可能性太多，就会越来越不方便。对于更复杂的条件，建议使用 <code class="highlighter-rouge">case</code> 语句：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">case</span> EXPRESSION <span class="k">in
</span>CASE1<span class="p">)</span>
	COMMAND-LIST
	<span class="p">;;</span>
CASE2<span class="p">)</span>
	COMMAND-LIST
	<span class="p">;;</span>
 ...
CASEN<span class="p">)</span>
	COMMAND-LIST
	<span class="p">;;</span>
<span class="k">esac</span>
</code></pre></div></div>

<h2 id="8-编写交互式脚本">8. 编写交互式脚本</h2>

<h3 id="81-显示用户消息">8.1 显示用户消息</h3>

<h4 id="811">8.1.1</h4>

<p>有些脚本运行时不需要与用户进行任何交互，它们的优点：</p>

<ul>
  <li>每次的运行结果可预知</li>
  <li>可在后台运行</li>
</ul>

<p>然而有些脚本需要用户的输入，或需要给用户提供输出，它们的优点：</p>

<ul>
  <li>可以做的更灵活</li>
  <li>脚本运行时可以有多种可能性</li>
  <li>脚本运行时可以汇报其运行进度</li>
</ul>

<p>编写交互式脚本时，要尽可能地添加注释。如果脚本能够提示合适的消息，则对用户更友好，更容易调试。否则就等着接投诉电话吧。因此，需要等待时可以提示用户 “当前正在计算，请稍等”，如果计算时间会很久，可以考虑在脚本的输出中添加一个进度提示。</p>

<p>当提示用户输入时，也应该尽可能详细地说明对输入数据的要求，包括参数和用法等。</p>

<h4 id="812-使用-echo">8.1.2 使用 <code class="highlighter-rouge">echo</code></h4>

<p><code class="highlighter-rouge">echo</code> 为内建命令，它会将其参数输出，用空格分隔，在换行符处终止。返回状态永远是 0。</p>

<p><code class="highlighter-rouge">echo</code> 可以用的选项：</p>

<ul>
  <li><code class="highlighter-rouge">-e</code> ：识别反斜线转义序列，如 <code class="highlighter-rouge">\n</code>、<code class="highlighter-rouge">\a</code> 等</li>
  <li><code class="highlighter-rouge">-n</code> ：行尾不加换行符，输出会紧接着下一个提示符</li>
</ul>

<p>以下为 <code class="highlighter-rouge">echo</code> 可用的转义序列：</p>

<table>
  <thead>
    <tr>
      <th>序列</th>
      <th>作用</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">\a</code></td>
      <td>警示字符，提示音</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\b</code></td>
      <td>回退字符</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\c</code></td>
      <td>取消输出中最后一个参数后面的换行符。 <code class="highlighter-rouge">\c</code> 序列后面的所有字符都将被忽略。</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\e</code></td>
      <td>转义符，用于转义控制字符</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\f</code></td>
      <td>馈页</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\n</code></td>
      <td>换行</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\r</code></td>
      <td>回车</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\t</code></td>
      <td>水平制表符</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\v</code></td>
      <td>垂直制表符</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\\</code></td>
      <td>反斜线</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\0NNN</code></td>
      <td>3 位 8 进制数字</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\NNN</code></td>
      <td>3 位二进制数字</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\xHH</code></td>
      <td>2 位十六进制数字</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>【 关于 <code class="highlighter-rouge">\e</code> 转义符 】
ASCII 码的前 32 个字符被保留，做为控制字符，也叫转义序列。这些控制字符不是为了输出可见信息，而是为了控制使用 ASCII 码的设备（打印机、显示器等），或为数据流提供元信息（如磁带中的数据流）。
转义序列通常可以通过 <strong><code class="highlighter-rouge">Ctrl</code></strong> 键与其它键的组合来 <strong>模拟</strong>。
第 <strong>27</strong> （十进制）个转义符，即八进制的第 33 个（\033），十六进制的 <code class="highlighter-rouge">0x1b</code>，是转义序列符。不同的 shell、不同的语言和工具处理起来会有所不同。可以用 <code class="highlighter-rouge">Ctrl - [</code> 来模拟，即 <code class="highlighter-rouge">^[</code>。
在输出时，要想使用控制字符，必须在其前面加上 <code class="highlighter-rouge">\e</code> 转义符，这样像 <code class="highlighter-rouge">echo -e</code> 这样的命令才能识别。
常见的控制字符：
<strong>7</strong>，响铃字符，会发出响铃以警示用户。bell，<code class="highlighter-rouge">BEL</code>，<code class="highlighter-rouge">\a</code>，<code class="highlighter-rouge">^G</code>
<strong>8</strong>，覆盖显示前一个字符。backspace，<code class="highlighter-rouge">BS</code>，<code class="highlighter-rouge">\b</code>，<code class="highlighter-rouge">^H</code>
<strong>10</strong>，换行符。line feed，<code class="highlighter-rouge">LF</code>，<code class="highlighter-rouge">\n</code>，<code class="highlighter-rouge">^J</code></p>
</blockquote>

<h3 id="82-捕捉用户的输入">8.2 捕捉用户的输入</h3>

<h4 id="821-read-命令">8.2.1 <code class="highlighter-rouge">read</code> 命令</h4>

<p><code class="highlighter-rouge">read</code> 是内建命令，与 <code class="highlighter-rouge">echo</code> 相反，它要读取用户的输入。</p>

<p><code class="highlighter-rouge">read [options] NAME1 NAME2 ... NAMEN</code></p>

<p><code class="highlighter-rouge">read</code> 命令会从命令行读取一行，或者从文件描述符中读取。读取到的第一个字段被分配给变量 <code class="highlighter-rouge">NAME1</code>，以此类推。</p>

<p>变量值中的 <code class="highlighter-rouge">IFS</code> 用于分割输入行。</p>

<p>反斜线用于转义或继续上行输入。</p>

<p>如果在 <code class="highlighter-rouge">read</code> 命令中没有指定 <code class="highlighter-rouge">NAME1</code> 这些变量，读取的行会赋予变量 <code class="highlighter-rouge">REPLY</code>。</p>

<p><code class="highlighter-rouge">read</code> 通常返回代码为 0。除非遇到 <code class="highlighter-rouge">EOF</code> 字符，或超时，或参数中的文件描述符无效。</p>

<h5 id="read-命令的选项"><code class="highlighter-rouge">read</code> 命令的选项</h5>

<table>
  <thead>
    <tr>
      <th>选项</th>
      <th>作用</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">-a ANAME</code></td>
      <td>字段会被依次分配给数组变量 <code class="highlighter-rouge">ANAME</code>，索引从 0 开始。为该数组赋值之前，会先清空该数组。</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">-d DELIM</code></td>
      <td>用来结束输入行的不再是换行符，而是 <code class="highlighter-rouge">DELIM</code> 中的第一个字符</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">-e</code></td>
      <td>用 <code class="highlighter-rouge">readline</code> 命令来读取输入行</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">-n NCHARS</code></td>
      <td><code class="highlighter-rouge">read</code> 命令在读取到 <code class="highlighter-rouge">NCHARS</code> 这个字符后立即返回，而不会读完整行输入</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">-p PROMPT</code></td>
      <td>在读取输入之前，先在终端上显示一个提示信息 <code class="highlighter-rouge">PROMPT</code>，只对从终端读取输入有效</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">-r</code></td>
      <td>反斜线不再有转义和继续上一行的作用</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">-s</code></td>
      <td>安静模式，如果从终端读取输入，键入的文字不会被回显</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">-t TIMEOUT</code></td>
      <td>设置超时，指定时间内如果没有能够读取到一行输入就超时。仅适用于从终端和管道读取输入。</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">-u FD</code></td>
      <td>从文件描述符 FD 中读取输入</td>
    </tr>
  </tbody>
</table>

<h4 id="822-用户输入的提示信息">8.2.2 用户输入的提示信息</h4>

<p>在使用 <code class="highlighter-rouge">read</code> 命令来读取用户输入时，要确保用户明白你需要的数据是什么。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"Enter your name and press [ENTER]: "</span>
<span class="nb">read </span>name
<span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"Enter your gender and press [ENTER]: "</span>
<span class="nb">read</span> <span class="nt">-n</span> 1 gender
</code></pre></div></div>

<h4 id="823-重定向与文件描述符">8.2.3 重定向与文件描述符</h4>

<h5 id="8231-一般用法">8.2.3.1 一般用法</h5>

<p>脚本中也可以发生重定向，如从文件中读取输入，或把输出发送给文件。</p>

<p>文件的输入和输出是由文件描述符完成的，最常用的是标准输入、标准输出、标准错误，分别为 0，1，2。</p>

<p>bash 也可以把网络主机上的 TCP 或 UDP <strong>端口做为文件描述符</strong> 来使用。</p>

<p>执行某个命令时，以下步骤会依次发生：</p>

<ul>
  <li>如果上一个命令的标准输出正通过管道被定向到当前命令的标准输入，<code class="highlighter-rouge">/proc/&lt;current_process_ID&gt;/fd/0</code> 会更新，指向与 <code class="highlighter-rouge">/proc/&lt;previous_process_ID/fd/1</code> 相同的匿名管道。</li>
  <li>如果当前命令的标准输出通过管道被重定向到下一个命令的标准输入，<code class="highlighter-rouge">/proc/&lt;current_process_ID/fd/1</code> 会更新，指向另一个匿名管道。</li>
  <li>针对当前命令的重定向是从左向右处理的</li>
  <li>一条命令后面的重定向 <code class="highlighter-rouge">N&gt;&amp;M</code> 或 <code class="highlighter-rouge">N&lt;&amp;M</code>，其效果等同于用与 <code class="highlighter-rouge">/proc/self/fd/M</code> 相同的目标，来创建或更新符号链接 <code class="highlighter-rouge">/proc/self/fd/N</code>。</li>
  <li>重定向 <code class="highlighter-rouge">N&gt; file</code> 或 <code class="highlighter-rouge">N&lt; file</code> ，其效果等同于用目标文件创建或更新符号链接 <code class="highlighter-rouge">/proc/self/fd/N</code></li>
  <li><code class="highlighter-rouge">N&gt;&amp;-</code> 其效果等同于删除符号链接 <code class="highlighter-rouge">/proc/self/fd/N</code></li>
  <li>只有到现在，当前的命令才执行</li>
</ul>

<p>从命令行中执行脚本时，不会发生太多的改变，因为子 shell 进程使用的文件描述符与父 shell 相同。如果父进程不存在，如通过 <code class="highlighter-rouge">cron</code> 来运行脚本时，标准的文件描述符是管道或其它临时文件，除非使用重定向。</p>

<h5 id="8232-对错误进行重定向">8.2.3.2 对错误进行重定向</h5>

<p>重定向标准错误时，一定要记住，<strong>顺序至关重要</strong>。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> <span class="nt">-l</span> <span class="k">*</span> 2&gt; /var/tmp/unaccessible-in-spool
</code></pre></div></div>

<p>把错误重定向到文件。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> <span class="nt">-l</span> <span class="k">*</span> <span class="o">&gt;</span> /var/tmp/spoollist 2&gt;&amp;1
</code></pre></div></div>

<p>把标准输出和标准错误都重定向到文件：</p>

<p>先把标准输出重定向到文件，再把标准错误重定向到标准输出。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> <span class="nt">-l</span> <span class="k">*</span> 2 <span class="o">&gt;</span>&amp; 1 <span class="o">&gt;</span> /var/tmp/spoollist
</code></pre></div></div>

<p>先把标准错误重定向到当前的标准输出，再把当前的标准输出重定向到文件。因此最终只有标准输出被重定向到文件。</p>

<p>为了方便，经常把错误重定向到 <code class="highlighter-rouge">/dev/null</code>。</p>

<p class="notice--info"><strong><code class="highlighter-rouge">&amp;&gt; FILE</code></strong>  等效于 <code class="highlighter-rouge">&gt; FILE 2&gt;&amp;1</code>，使用起来更简单。</p>

<h4 id="824-文件输入与输出">8.2.4 文件输入与输出</h4>

<h5 id="8241-使用文件描述符">8.2.4.1 使用文件描述符</h5>

<p><code class="highlighter-rouge">/dev/fd</code> 目录包含了所有的描述符，如 0，1，2 等。打开文件 <code class="highlighter-rouge">/dev/fd/N</code> 相当于复制文件描述符 N。如果当前系统提供 <code class="highlighter-rouge">/dev/stdin</code>、<code class="highlighter-rouge">/dev/stdout</code>、<code class="highlighter-rouge">/dev/stderr</code>，你会看到它们只是指向 <code class="highlighter-rouge">/dev/fd/0</code>、<code class="highlighter-rouge">/dev/fd/1</code>、<code class="highlighter-rouge">/dev/fd/2</code> 的符号链接。</p>

<p><code class="highlighter-rouge">/dev/fd</code> 中的文件主要是在 shell 中使用，通过该机制，以路径为参数的那些程序可以像对待其它路径一样来操作这些描述符。 如果 <code class="highlighter-rouge">/dev/fd</code> 在当前系统不可用，可以用 <code class="highlighter-rouge">-</code> 来代替标准输入或标准输出。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>filter body.txt.gz | <span class="nb">cat </span>header.txt - footer.txt | lp
filter body.txt | <span class="nb">cat </span>header.txt /dev/fd/0 footer.txt | lp
</code></pre></div></div>

<p>以上两条命令是等效的，将三个文档打印出来。</p>

<h5 id="8242-read-和-exec">8.2.4.2 <code class="highlighter-rouge">read</code> 和 <code class="highlighter-rouge">exec</code></h5>

<h6 id="为文件分配描述符">为文件分配描述符</h6>

<p><code class="highlighter-rouge">exec</code> 命令可用来替换当前的 shell，或更改当前 shell 的描述符。</p>

<p>例如，可以用来给文件分配一个描述符：</p>

<p><code class="highlighter-rouge">exec fdN&gt; file</code>  给文件分配描述符，用于输出</p>

<p><code class="highlighter-rouge">exec fdN&lt; file</code>  给文件分配描述符，用于输入</p>

<p>然后就可以在 shell 中直接使用描述符了：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">exec </span>4&gt; result.txt

filter body.txt | <span class="nb">cat </span>header.txt /dev/fd/0 footer.txt <span class="o">&gt;</span>&amp; 4
</code></pre></div></div>

<p>给文件 <code class="highlighter-rouge">result.txt</code> 分配描述符 4，用于输出，然后把三个文件的输出及错误全部保存到该文件。</p>

<p class="notice--warning">描述符 5 可能会造成问题，因为 bash 用 <code class="highlighter-rouge">exec</code> 创建子 shell 时，其子进程会继承描述符 5，最好保留这个描述符不要使用。</p>

<h6 id="读取脚本">读取脚本</h6>

<p>该脚本会把重要的配置文件制作索引，将它们放到一个备份文件中。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">CONFIG</span><span class="o">=</span>/var/tmp/sysconfig.out
<span class="nb">rm</span> <span class="s2">"</span><span class="nv">$CONFIG</span><span class="s2">"</span> 2&gt;/dev/null

<span class="nb">echo</span> <span class="s2">"Output will be saved in </span><span class="nv">$CONFIG</span><span class="s2">."</span>

<span class="nb">exec </span>7&lt;&amp;0
<span class="c"># 创建描述符 7，用于输入，与描述符 0 的目标相同</span>
<span class="c"># 相当于把描述符 0 的值先保存到 7 里</span>

<span class="nb">exec</span> &lt; /etc/passwd
<span class="c"># 更新描述符 0 为 /etc/passwd 文件，此时标准输入为一个文件</span>

<span class="nb">read </span>rootpasswd
<span class="c"># 从标准输入读取数据，相当于读取 passwd 文件的第一行内容</span>

<span class="nb">echo</span> <span class="s2">"Your root account info:"</span> <span class="o">&gt;&gt;</span> <span class="nv">$CONFIG</span>
<span class="c"># 把一行说明信息追加到配置文件中</span>

<span class="nb">echo</span> <span class="nv">$rootpasswd</span> <span class="o">&gt;&gt;</span> <span class="s2">"</span><span class="nv">$CONFIG</span><span class="s2">"</span>
<span class="c"># 把从 passwd 读取到的第一行数据追加到配置文件</span>

<span class="nb">exec </span>0&lt;&amp;7 7&lt;&amp;-
<span class="c"># 把原来保存在描述符 7 里的值还给 0，恢复之前的描述符 0</span>
<span class="c"># 删除描述符 7</span>

<span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"Enter comment or [ENTER] for no comment: "</span>
<span class="nb">read </span>comment<span class="p">;</span> <span class="nb">echo</span> <span class="nv">$comment</span> <span class="o">&gt;&gt;</span> <span class="s2">"</span><span class="nv">$CONFIG</span><span class="s2">"</span>
<span class="c"># 此时 read 就会从命令行读取了</span>
</code></pre></div></div>

<h5 id="8243-关闭文件描述符">8.2.4.3 关闭文件描述符</h5>

<p>因为子进程会继承打开文件的描述符，所以不再需要时要及时将其关闭：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">exec </span>7&lt;&amp;-
</code></pre></div></div>

<h5 id="8244-here-文档">8.2.4.4 Here 文档</h5>

<p>编写脚本时，调用的程序或脚本经常需要输入。shell 可以通过 here 文档来读取输入，直到某行只包含关键字符串，且其后面没有空白字符。到此行读取的所有内容将一起做为标准输入。</p>

<p>使用 here 文档就可以免于调用单独的文件了，而且比用一堆 <code class="highlighter-rouge">echo</code> 也简单一些。</p>

<p>虽然名字叫 here 文档，实际上它是脚本中的一种 <strong>结构</strong> 而已。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Start here document</span>
<span class="nb">cat</span> <span class="o">&lt;&lt;</span> <span class="no">BROWSERS</span><span class="sh">
mozilla
links
lynx
konqueror
opera
netscape
</span><span class="no">BROWSERS
</span><span class="c"># End here document</span>
</code></pre></div></div>

<p>……….</p>

        
      </section>




      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
	<hr />
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> 标签: </strong>
    <span itemprop="keywords">
    
		
      <a href="/tag/shell" class="page__taxonomy-item" rel="tag">shell</a><span class="sep">  </span>
    
		
      <a href="/tag/bash" class="page__taxonomy-item" rel="tag">bash</a><span class="sep">  </span>
    
		
      <a href="/tag/sed" class="page__taxonomy-item" rel="tag">sed</a><span class="sep">  </span>
    
		
      <a href="/tag/awk" class="page__taxonomy-item" rel="tag">awk</a>
    
    </span>
  </p>













  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> 分类: </strong>
	<!--  <hr />    -->
    <span itemprop="keywords">
    
      
      
      <a href="http://localhost:4000/categories/#programming" class="page__taxonomy-item" rel="tag">programming</a>
    
    </span>
  </p>




        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 更新时间:</strong> <time datetime="2017-05-03T00:00:00+08:00">May 03, 2017</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">分享</h4>
  

  <a href="https://twitter.com/intent/tweet?via=liloli&text=Bash+%E5%85%A5%E9%97%A8+02%20http%3A%2F%2Flocalhost%3A4000%2Fprogramming%2Fbash02%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="分享 Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fprogramming%2Fbash02%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="分享 Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http%3A%2F%2Flocalhost%3A4000%2Fprogramming%2Fbash02%2F" class="btn btn--google-plus" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="分享 Google Plus"><i class="fab fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fprogramming%2Fbash02%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="分享 LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="http://localhost:4000/programming/bash01/" class="pagination--pager" title="Bash 入门 01
">向前</a>
    
    
      <a href="http://localhost:4000/programming/bash03/" class="pagination--pager" title="Bash 入门 03
">向后</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">猜您还喜欢</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/bash/time/" rel="permalink">Bash 脚本 - 时间
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/bash/storage/" rel="permalink">Bash 脚本 - 存储空间
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/bash/numbers/" rel="permalink">Bash 脚本 - 数字
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/bash/input/" rel="permalink">Bash 脚本 - 输入
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>
        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap">
  <input type="text" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  <div id="results" class="results"></div>
</div>
      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->


<!-- end custom footer snippets -->

        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>关注:</strong></li>
    
    
      <li><a href="https://twitter.com/liloli"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
      <li><a href="https://www.facebook.com/lilolibj"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i> Facebook</a></li>
    
    
      <li><a href="https://github.com/liloli"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    
    <li><a href="http://localhost:4000/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2018 Hawk Zhang. 技术来自于 <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="http://localhost:4000/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>



  
  
  <script src="http://localhost:4000/assets/js/lunr/lunr.min.js"></script>
  <script src="http://localhost:4000/assets/js/lunr/lunr-store.js"></script>
  <script src="http://localhost:4000/assets/js/lunr/lunr-en.js"></script>





    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/programming/bash02/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/programming/bash02"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://liloli.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  



  </body>
</html>
