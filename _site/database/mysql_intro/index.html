<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.9.1 by Michael Rose
  Copyright 2013-2018 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="zh" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>MySQL 入门 - LINOTES</title>
<meta name="description" content="用简洁清晰的语言讨论技术">



<meta property="og:type" content="article">
<meta property="og:locale" content="zh_CN">
<meta property="og:site_name" content="LINOTES">
<meta property="og:title" content="MySQL 入门">
<meta property="og:url" content="http://localhost:4000/database/mysql_intro/">


  <meta property="og:description" content="用简洁清晰的语言讨论技术">



  <meta property="og:image" content="http://localhost:4000/assets/images/header/mysql.jpg">



  <meta name="twitter:site" content="@liloli">
  <meta name="twitter:title" content="MySQL 入门">
  <meta name="twitter:description" content="用简洁清晰的语言讨论技术">
  <meta name="twitter:url" content="http://localhost:4000/database/mysql_intro/">

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="http://localhost:4000/assets/images/header/mysql.jpg">
  

  



  <meta property="article:published_time" content="2016-03-01T00:00:00+08:00">





  

  


<link rel="canonical" href="http://localhost:4000/database/mysql_intro/">







  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "Hawk Zhang",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="LINOTES Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- <link rel="stylesheet" href="/assets/css/vim.css"> -->



  









<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="http://localhost:4000/">LINOTES</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/app/rsync/" >Rsync 的用法</a>
            </li>
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/server/vsftpd/" >Vsftpd 的用法</a>
            </li>
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/kernel/filedescriptor/" >文件描述符简介</a>
            </li>
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/tools/tools.datastream/" >数据流处理</a>
            </li>
          
        </ul>
        
        <button class="search__toggle" type="button">
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">切换菜单</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    <div class="initial-content">
      
  











<div class="page__hero--overlay"
  style=" background-image: linear-gradient(rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.8)), url('http://localhost:4000/assets/images/header/mysql.jpg');"
>
  
    <div class="wrapper">
      <h1 class="page__title" itemprop="headline">
        
          MySQL 入门

        
      </h1>
      
        <p class="page__lead">
</p>
      
      
      
    </div>
  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="http://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="http://localhost:4000/assets/images/bio-photo.jpg" alt="Hawk Zhang" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Hawk Zhang</h3>
    
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">关注</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">北京</span>
        </li>
      

      

      
        <li>
          <a href="mailto:liloli@gmail.com">
            <meta itemprop="email" content="liloli@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> 电子邮箱
          </a>
        </li>
      

      

      
        <li>
          <a href="https://twitter.com/liloli" itemprop="sameAs">
            <i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter
          </a>
        </li>
      

      

      

      
        <li>
          <a href="https://www.linkedin.com/in/hawkzhang" itemprop="sameAs">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://github.com/liloli" itemprop="sameAs">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
    
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">切换菜单</label>
  <ul class="nav__items">
    
  </ul>
</nav>
    
  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="MySQL 入门">
    <meta itemprop="description" content="">
    <meta itemprop="datePublished" content="March 01, 2016">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-copy"></i> MySQL 入门</h4></header>
              <ul class="toc__menu">
  <li><a href="#mysql-简介">MySQL 简介</a>
    <ul>
      <li><a href="#mysql-特点">MySQL 特点</a></li>
      <li><a href="#应用">应用</a></li>
      <li><a href="#mysql-管理">MySQL 管理</a></li>
      <li><a href="#连接方式">连接方式</a></li>
      <li><a href="#派生版本">派生版本</a></li>
    </ul>
  </li>
  <li><a href="#mysql-的安装">MySQL 的安装</a>
    <ul>
      <li><a href="#选择版本">选择版本</a></li>
      <li><a href="#mysql-文件分布">MySQL 文件分布</a></li>
      <li><a href="#安装-mysql">安装 MySQL</a></li>
    </ul>
  </li>
  <li><a href="#mysql-的简单操作">MySQL 的简单操作</a>
    <ul>
      <li><a href="#连接到-mysql-服务器">连接到 MySQL 服务器</a></li>
      <li><a href="#查询">查询</a></li>
      <li><a href="#创建和使用数据库">创建和使用数据库</a></li>
      <li><a href="#查看数据库和表格的信息">查看数据库和表格的信息</a></li>
      <li><a href="#mysql-批处理模式">MySQL 批处理模式</a></li>
      <li><a href="#与-apache-配合使用-mysql">与 Apache 配合使用 MySQL</a></li>
    </ul>
  </li>
</ul>
            </nav>
          </aside>
        
        <h2 id="mysql-简介">MySQL 简介</h2>

<p>本节内容主要引自 <a href="https://dev.mysql.com/doc/refman/8.0/en/"> MySQL 8.0 Reference Manual </a></p>

<p>MySQL 是一款开源的关系数据库管理系统（RDBMS），最早由瑞典公司 MySQL AB 拥有，现在归 Oracle 所有。对于专有使用，有几个付费版本可用，并提供额外的功能。</p>

<p>MySQL 是开源网页应用软件栈 LAMP 的中心组件。MySQL 常被用于许多大型网站。</p>

<p>MySQL 是用 C 和 C++ 语言编写的，可工作于许多系统平台。</p>

<p>当前仍在支持的版本为 5.5、5.6、5.7，最新版本为 8.0。</p>

<h3 id="mysql-特点">MySQL 特点</h3>

<p>MySQL 提供两个版本：开源社区服务器版和企业专用服务器版。</p>

<p>企业版含有一系列专用的扩展，以服务器插件的形式安装。</p>

<ul>
  <li>为多种编程语言提供了 API，包括 C、Java、PHP、Python、Ruby 等</li>
  <li>支持多线程，充分利用 CPU 资源，支持多用户</li>
  <li>优化的 SQL 查询算法，有效地提高查询速度</li>
  <li>既能够作为一个单独的应用程序在客户端服务器网络环境中运行，也能够作为一个程序库而嵌入到其他的软件中</li>
  <li>提供 TCP/IP、ODBC 和 JDBC 等多种数据库连接途径</li>
  <li>提供用于管理、检查、优化数据库操作的管理工具</li>
  <li>可以处理拥有上千万条记录的大型数据库</li>
</ul>

<h3 id="应用">应用</h3>

<p>与其他的大型数据库例如 Oracle、IBM DB2、MS SQL 等相比，MySQL 自有它的不足之处，如规模小、功能有限等，但是这丝毫也没有减少它受欢迎的程度。对于一般的个人用户和中小型企业来说，MySQL 提供的功能已经绰绰有余，而且由于 MySQL 是开放源代码软件，因此可以大大降低总体拥有成本。</p>

<p>2010 年以前互联网上流行的网站构架方式是 LAMP（Linux Apache MySQL PHP），即使用 Linux 作为操作系统，Apache 作为 Web 服务器，MySQL 作为数据库，PHP（部分网站也使用 Perl 或 Python）作为服务器端脚本解释器。由于这四个软件都是开放源代码软件，因此使用这种方式可以以较低的成本创建起一个稳定、免费的网站系统。</p>

<p>MySQL + PHP 的搭配在互联网上的应用相比 LAMP 来说更为常见，并获得了 “动态配对”（Dynamic Duo）的雅号，大部分 Blog 网站基于的 WordPress 系统即基于此。除了 LAMP 之外，用于 Solaris、Windows 和 Mac 上的网站构架也分别被称为 SAMP、WAMP 和 MAMP。</p>

<h3 id="mysql-管理">MySQL 管理</h3>

<p>可以使用命令行工具管理 MySQL 数据库（命令为 <code class="highlighter-rouge">mysql</code> 和 <code class="highlighter-rouge">mysqladmin</code>），也可以从 MySQL 的网站下载图形管理工具 MySQL Workbench。</p>

<p>Navicat 导航猫 for MySQL 是一套专为 MySQL 设计的强大数据库管理及开发工具。它可以用于任何版本的 MySQL 数据库，并支持大部分 MySQL 的功能，包括触发器、索引、查看等。</p>

<p>phpMyAdmin 是由 PHP 写成的 MySQL 数据库系统管理程序，让管理者可用 Web 接口管理 MySQL 数据库。借由此 Web 接口可以成为一个简易方式输入繁杂SQL语法的较佳途径，尤其要处理大量数据的导入及导出更为方便。其中一个更大的优势在于由于 phpMyAdmin 跟其他 PHP 程序一样在网页服务器上运行，但是您可以在任何地方使用这些程序产生的 HTML 页面，即远程管理你的 MySQL 数据库。使用 phpMyAdmin 可以方便的创建、修改、删除数据库及数据表。</p>

<p>phpMyBackupPro 也是由 PHP 写成的，可以通过 Web 接口创建和管理数据库。它可以创建伪 cronjobs，可以自动在某个时间或周期性备份 MySQL 数据库。</p>

<h3 id="连接方式">连接方式</h3>

<p>应用程序可通过 ODBC 或 ADO 方式，经由使用 MyODBC 与 MySQL 数据库连接。</p>

<p>MS.Net Framework 下的程序（例如：C#、VB.NET）可通过 ADO.NET 的方式，经由使用 MySQL.Net 与 MySQL 数据库连接。</p>

<p>C/C++ 可使用 MySQL++ 或是直接使用 MySQL 内置 API 与 MySQL 数据库连接。</p>

<p>PHP 可通过 PHP 的 MySQLi 与 MySQL 数据库连接，具备比 MySQL 模块更好的性能。另外 PHP6 可使用 mysqlnd 与 MySQL 数据库连接。</p>

<p>JAVA 程序可通过 JDBC 方式与 MySQL 进行连接，MySQL 官方提供了 JDBC 驱动程序。</p>

<p>可通过 MySQL 客户端软件与 MySQL 进行连接，如 mysqlfront、mysqlyog、mysqlbrowser 等。</p>

<p>javascript 可以通过使用 fibjs 的内置 mysql 模块与 MySQL 数据库连接。</p>

<h3 id="派生版本">派生版本</h3>

<p>派生版本有 Drizzle、MariaDB、Percona Server 及 OurDelta 等。</p>

<h2 id="mysql-的安装">MySQL 的安装</h2>

<h3 id="选择版本">选择版本</h3>

<p><a href="https://www.mysql.com/support/supportedplatforms/database.html">在 MySQL 官网查询各平台可用版本。</a></p>

<p>首先要考虑是安装二进制文件还是源代码，其次要考虑是安装开发版本还是一般可用版本（GA，General Availability）。开发版会有些新的功能，但不推荐实际生产使用。GA 版本也称生产版，或稳定版，是为生产准备的。因此推荐安装最新的 GA 版本。</p>

<h4 id="版本命名">版本命名</h4>

<p>版本 8.0 的命名规则为三个数字加上一个可选的后缀，如 mysql-8.0.1-dmr。</p>

<p>三位数字含义：</p>

<ul>
  <li><code class="highlighter-rouge">8</code> ：主版本号</li>
  <li><code class="highlighter-rouge">0</code> ：次版本号。主+次版本号组合在一起即发行序列版本号，该版本号决定了其稳定的功能组成。</li>
  <li><code class="highlighter-rouge">1</code> : 序列版本号内的版本号，每次小更新会加 1，多数情况下，某序列版本的最新版本是比较好的选择。</li>
</ul>

<p>后缀：</p>

<p>后缀为可选，用于表示该版本的稳定级别。</p>

<ul>
  <li><code class="highlighter-rouge">dmr</code> ： Development Milestone Release，DMR 里程碑版本。MySQL 开发时使用一种里程碑模型，每个里程碑会带来一小组经测试的新功能。从一个里程碑到下一个，功能接口可能会发生改变，甚至可能被删除，均基于社区成员的测试反馈。里程碑版本中的功能可以看作前生产水平。</li>
  <li><code class="highlighter-rouge">rc</code> ： Release Candidate，RC。候选发布版，最终测试版本。该版本比较稳定，通过了所有 MySQL 内部测试。RC 版本中仍有可能加入新功能，但其精力主要集中在修复之前版本功能的 bug。</li>
  <li>无后缀 ： General Availability，GA。最终稳定版。</li>
</ul>

<h4 id="文件格式">文件格式</h4>

<p>多数情况下应该选择二进制版本，如 RPM 软件包。</p>

<p>其他情况下，有可能会需要从源代码版本来安装：</p>

<ul>
  <li>需要把 MySQL 安装到特殊位置</li>
  <li>需要为 mysqld 配置一些在标准二进制软件包中没有的功能，常用的有：
    <ul>
      <li><code class="highlighter-rouge">-DWITH_LIBWRAP=1</code> 支持 TCP 包裹</li>
      <li><code class="highlighter-rouge">-DWITH_ZLIB={system|bundled}</code> 安装基于压缩的功能</li>
      <li><code class="highlighter-rouge">-DWITH_DEBUG=1</code> 支持调试</li>
    </ul>
  </li>
  <li>需要配置 mysqld 时去掉某些功能</li>
  <li>需要阅读或修改 MySQL 的源文件</li>
  <li>源代码版本包含更多的测试和范例</li>
</ul>

<h3 id="mysql-文件分布">MySQL 文件分布</h3>

<table>
  <thead>
    <tr>
      <th>目录</th>
      <th>内容</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">bin</code></td>
      <td>mysqld 服务器，客户端，及工具软件</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">docs</code></td>
      <td>说明文档，info 格式</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">man</code></td>
      <td>man pages</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">include</code></td>
      <td>头文件</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">lib</code></td>
      <td>运行库</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">share</code></td>
      <td>错误消息，词典，数据库安装的 SQL</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">support-files</code></td>
      <td>其它支持文件</td>
    </tr>
  </tbody>
</table>

<h3 id="安装-mysql">安装 MySQL</h3>

<p>安装</p>

<p><code class="highlighter-rouge">sudo yum install mysql-community-server</code></p>

<p>启动</p>

<p><code class="highlighter-rouge">sudo systemctl start mysqld.service</code></p>

<h4 id="mysql-server-初始化">MySQL Server 初始化</h4>

<p>在服务初始化启动时，会发生以下事件：</p>

<ul>
  <li>服务器初始化</li>
  <li>生成 SSL 证书与密钥文件</li>
  <li>安装并启用密码验证插件</li>
  <li>创建超级用户 <code class="highlighter-rouge">root'，用 </code>sudo grep ‘temporary password’ /var/log/mysqld.log` 查询其初始密码</li>
</ul>

<p>安装后要第一时间修改超级用户的密码：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>mysql <span class="nt">-u</span> root <span class="nt">-p</span>
mysql&gt; ALTER USER <span class="s1">'root'</span>@<span class="s1">'localhost'</span> IDENTIFIED BY <span class="s1">'MyNewPass4!'</span><span class="p">;</span>
</code></pre></div></div>

<p>MySQL 的密码验证插件是默认安装的，它会要求密码至少有一个大写字母、一个小写字母、一位数字、一个特殊符号，至少 8 位。</p>

<h2 id="mysql-的简单操作">MySQL 的简单操作</h2>

<h3 id="连接到-mysql-服务器">连接到 MySQL 服务器</h3>

<p>要想连接到服务器，通常需要 MySQL 用户名和密码，如果要连接到其它主机，还需要主机名。</p>

<h4 id="连接到远程主机">连接到远程主机</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>mysql <span class="nt">-h</span> host <span class="nt">-u</span> user <span class="nt">-p</span>
Enter password:
Welcome to the MySQL monitor.  Commands end with <span class="p">;</span> or <span class="se">\g</span><span class="nb">.</span>
Your MySQL connection <span class="nb">id </span>is 25338 to server version: 8.0.13-standard

Type <span class="s1">'help;'</span> or <span class="s1">'\h'</span> <span class="k">for </span>help. Type <span class="s1">'\c'</span> to clear the buffer.

mysql&gt;
</code></pre></div></div>

<h4 id="连接到本机">连接到本机</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>mysql <span class="nt">-u</span> user <span class="nt">-p</span>
</code></pre></div></div>

<h4 id="匿名访问">匿名访问</h4>

<p>如果本地主机开启了匿名 MySQL 访问，则无需用户名和密码，直接 <code class="highlighter-rouge">mysql</code> 就能进入。</p>

<h4 id="退出">退出</h4>

<p><code class="highlighter-rouge">QUIT</code>  注意，该命令后面不需要分号结束。</p>

<h3 id="查询">查询</h3>

<p>连接到服务器以后，可以进行数据库的查询。</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">VERSION</span><span class="p">(),</span> <span class="k">CURRENT_DATE</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-----------+--------------+</span>
<span class="o">|</span> <span class="k">VERSION</span><span class="p">()</span> <span class="o">|</span> <span class="k">CURRENT_DATE</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+--------------+</span>
<span class="o">|</span> <span class="mi">5</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="n">m17</span> <span class="o">|</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">21</span>   <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+--------------+</span>
<span class="mi">1</span> <span class="k">row</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">02</span> <span class="n">sec</span><span class="p">)</span>
<span class="n">mysql</span><span class="o">&gt;</span>
</code></pre></div></div>

<h4 id="查询要点">查询要点</h4>

<p>查询语句及关键字 <strong>不分大小写</strong>。</p>

<p>可以在一行键入多个查询语句，中间用分号分隔，如 <code class="highlighter-rouge">mysql&gt; SELECT VERSION(); SELECT NOW();</code>。</p>

<p>命令太长可以直接回车在下一行继续输入，如果中途要取消输入，可以键入 <code class="highlighter-rouge">\c</code>。</p>

<h4 id="查询结果">查询结果</h4>

<ul>
  <li>查询通常由 SQL 语句加上 <strong>分号</strong> 组成</li>
  <li>查询时，mysql 将语句发送给服务器执行，回显结果，返回提示符</li>
  <li>mysql 以 <strong>表格的形式</strong> 显示查询结果</li>
  <li>查询结果的最后会告知返回了 <strong>多少行</strong></li>
</ul>

<h4 id="提示符">提示符</h4>

<p>不同情况下会显示不同的提示符：</p>

<table>
  <thead>
    <tr>
      <th>提示符</th>
      <th>含义</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">mysql&gt;</code></td>
      <td>就绪，可以查询</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">-&gt;</code></td>
      <td>多行输入状态，等待下一行</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">'&gt;</code></td>
      <td>等待下一行，等待一个单引号开头的字符串的结束</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">"&gt;</code></td>
      <td>等待下一行，等待一个双引号开头的字符串的结束</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">`&gt;</code></td>
      <td>等待下一行，等待一个反引号开头的描述符的结束</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">/*&gt;</code></td>
      <td>等待下一行，等待一个 <code class="highlighter-rouge">/*</code> 开头的注释的结束</td>
    </tr>
  </tbody>
</table>

<p>如果命令行的结尾不是分号，通常就会进入多行输入状态：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">USER</span><span class="p">()</span>
    <span class="o">-&gt;</span>
</code></pre></div></div>

<p>此时如果你确认已经完成了语句的输入，直接键入分号，回车即可。</p>

<p>至于 <code class="highlighter-rouge">'&gt;</code> 和 <code class="highlighter-rouge">"&gt;</code> 提示符，主要发生在收集字符串期间，即 MySQL 在等待用户完成一个字符串的键入。在 MySQL 中，你可以用单引号或双引号把字符串引用起来，而且允许长字符串跨越多行。当看到 <code class="highlighter-rouge">'&gt;</code> 和 <code class="highlighter-rouge">"&gt;</code> 提示符时，说明你已经键入了一行以单引号或双引号开头的字符串，但还没有结束引用，只有结束了引用才算完成了字符串的键入。</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">my_table</span> <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'Smith AND age &lt; 30;
    '</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>第二行的提示符变成了 <code class="highlighter-rouge">'&gt;</code>，你才发现忘记给 <code class="highlighter-rouge">Smith</code> 结束引号了。此时，能做的只有键入 <code class="highlighter-rouge">\c</code> 来取消输入，回到正常提示符再重新输入。</p>

<h3 id="创建和使用数据库">创建和使用数据库</h3>

<h4 id="查看当前数据库">查看当前数据库</h4>

<p>通过 <code class="highlighter-rouge">SHOW DATABASE</code> 命令来查看当前数据库列表。</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SHOW</span> <span class="n">DATABASES</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span> <span class="k">Database</span>           <span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span> <span class="n">information_schema</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">mysql</span>              <span class="o">|</span>
<span class="o">|</span> <span class="n">performance_schema</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">sys</span>                <span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="mi">4</span> <span class="k">rows</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">04</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></div></div>

<p>该命令只能显示当前数据库用户有权访问的数据库。</p>

<p><code class="highlighter-rouge">mysql</code> 数据库用于描述用户访问权限。</p>

<h4 id="创建选择数据库">创建、选择数据库</h4>

<h5 id="创建数据库">创建数据库</h5>

<p>创建数据库的命令为 <code class="highlighter-rouge">CREATE</code>：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">test</span><span class="p">;</span>
</code></pre></div></div>

<p>数据库名字是大小写敏感的，要注意。同样，表格名称也是大小写敏感。</p>

<p>无论怎样，建议始终保持有规律的大小写命名规则。</p>

<h5 id="使用数据库">使用数据库</h5>

<p>每次开始一个 mqsql 会话时，在使用数据库之前，必须要先选择它，使用 <code class="highlighter-rouge">USE</code> 命令：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">USE</span> <span class="n">mysql</span>
<span class="k">Database</span> <span class="n">changed</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">USE</code> 命令在行尾也不需要分号。但你非要加也没问题。而且该命令必须 <strong>单独在一行执行</strong>。</p>

<p>另一种选择数据库的方法是在调用 mysql 时就选择：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span> <span class="n">mysql</span> <span class="o">-</span><span class="n">h</span> <span class="k">host</span> <span class="o">-</span><span class="n">u</span> <span class="k">user</span> <span class="o">-</span><span class="n">p</span> <span class="n">test</span>
<span class="n">Enter</span> <span class="n">password</span><span class="p">:</span>
</code></pre></div></div>

<h4 id="创建表格">创建表格</h4>

<h5 id="查看表格列表">查看表格列表</h5>

<p>用 <code class="highlighter-rouge">SHOW TABLES</code> 命令查看当前数据库表格列表</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SHOW</span> <span class="n">TABLES</span><span class="p">;</span>
<span class="n">Empty</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></div></div>

<h5 id="创建表格-1">创建表格</h5>

<p>用 <code class="highlighter-rouge">CREATE TABLE</code> 命令创建表格。</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">album</span> <span class="p">(</span><span class="n">name</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">artist</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
    <span class="o">-&gt;</span> <span class="k">year</span> <span class="n">DATE</span><span class="p">,</span> <span class="n">genre</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span> <span class="k">comment</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">90</span><span class="p">));</span>
</code></pre></div></div>

<p>为了确认表格创建成功，可以使用 <code class="highlighter-rouge">DESCRIBE</code> 命令来查看表格的结构：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">DESCRIBE</span> <span class="n">album</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------+-------------+------+-----+---------+-------+</span>
<span class="o">|</span> <span class="n">Field</span>    <span class="o">|</span> <span class="k">Type</span>        <span class="o">|</span> <span class="k">Null</span> <span class="o">|</span> <span class="k">Key</span> <span class="o">|</span> <span class="k">Default</span> <span class="o">|</span> <span class="n">Extra</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">----------+-------------+------+-----+---------+-------+</span>
<span class="o">|</span> <span class="n">name</span>     <span class="o">|</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span> <span class="o">|</span> <span class="n">YES</span>  <span class="o">|</span>     <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">artist</span>   <span class="o">|</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">|</span> <span class="n">YES</span>  <span class="o">|</span>     <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="k">year</span>     <span class="o">|</span> <span class="n">date</span>        <span class="o">|</span> <span class="n">YES</span>  <span class="o">|</span>     <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">genre</span>    <span class="o">|</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">|</span> <span class="n">YES</span>  <span class="o">|</span>     <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="k">comment</span>  <span class="o">|</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="o">|</span> <span class="n">YES</span>  <span class="o">|</span>     <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span>       <span class="o">|</span>
<span class="o">+</span><span class="c1">----------+-------------+------+-----+---------+-------+</span>
<span class="mi">5</span> <span class="k">rows</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="为表格填充数据">为表格填充数据</h4>

<p>表格创建以后，要想填充数据，可以使用 <code class="highlighter-rouge">LOAD DATA</code> 和 <code class="highlighter-rouge">INSERT</code> 命令来完成。</p>

<h5 id="用-load-data-导入文件">用 <code class="highlighter-rouge">LOAD DATA</code> 导入文件</h5>

<p>要想批量导入较多数据，可以事先编辑一个纯文本文件，每一行是一个记录，每个字段用 tab 分隔。</p>

<p>如果该条记录中某字段为空，可以用 <code class="highlighter-rouge">\N</code> 表示，即 NULL 空值。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>love 1990	LuoDaYou	1994-7-8	\N
</code></pre></div></div>

<p>导入时用以下方式：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">LOAD</span> <span class="k">DATA</span> <span class="k">LOCAL</span> <span class="n">INFILE</span> <span class="s1">'/path/albums.txt'</span> <span class="k">INTO</span> <span class="k">TABLE</span> <span class="n">album</span><span class="p">;</span>
</code></pre></div></div>

<p>如果文本文件是在 windows 操作系统中编辑的，其换行符会是 <code class="highlighter-rouge">\r\n</code>，因此上面的语句应换成：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">LOAD</span> <span class="k">DATA</span> <span class="k">LOCAL</span> <span class="n">INFILE</span> <span class="s1">'/path/albums.txt'</span> <span class="k">INTO</span> <span class="k">TABLE</span> <span class="n">album</span>
    <span class="o">-&gt;</span> <span class="n">LINES</span> <span class="n">TERMINATED</span> <span class="k">BY</span> <span class="s1">'</span><span class="se">\r\n</span><span class="s1">'</span><span class="p">;</span>
</code></pre></div></div>

<p>如果是在 MACOSX 中编辑的，则要换成 <code class="highlighter-rouge">LINES TERMINATED BY '\r'</code>。</p>

<h6 id="load-data-local-的安全隐患"><code class="highlighter-rouge">LOAD DATA LOCAL</code> 的安全隐患</h6>

<p><code class="highlighter-rouge">LOAD DATA</code> 语句可以加载 <strong>服务器本机</strong> 上的文件，也可以用 <code class="highlighter-rouge">LOAD DATA LOCAL</code> 来加载 <strong>客户端主机</strong> 中的文件。</p>

<p>使用 <code class="highlighter-rouge">LOAD DATA LOCAL</code> 会有以下风险：</p>

<ul>
  <li>从客户端主机向服务端主机 <strong>传送文件</strong> 是由 MySQL <strong>服务端发起</strong> 的。理论上讲，可以做到服务器通知客户端程序，让其发送由服务端选择的文件，而非由客户端执行的 <code class="highlighter-rouge">LOAD DATA</code> 语句指定文件名。这样的服务端可以访问客户端主机中，当前用户有权访问的所有文件。实际上，这样的服务器可以设置成对客户端发送的任何语句都回应一个发送文件的请求，不仅仅针对 <code class="highlighter-rouge">LOAD DATA LOCAL</code> 语句。因此，最根本的安全隐患在于，<strong>客户端不要连接到不可信的服务器</strong>。</li>
  <li>在网页服务器的环境下，数据库客户端是从网页服务器发起连接的，数据库用户可以通过 <code class="highlighter-rouge">LOAD DATA LOCAL</code> 语句，从网页服务器读取任何该网页服务进程有权读取的文件。在这种环境下，对 MySQL 服务端来说，其 <strong>客户端实际上是网页服务器</strong>，而不是连接到网页服务器上的某个远程用户。</li>
</ul>

<h6 id="如何启用-load-data-local">如何启用 <code class="highlighter-rouge">LOAD DATA LOCAL</code></h6>

<p>为了防止 <code class="highlighter-rouge">LOAD DATA</code> 造成问题，客户端应避免使用 <code class="highlighter-rouge">LOCAL</code>，并且应避免连接到不可信的服务器。连接时，应使用 <code class="highlighter-rouge">--ssl-mode=VERIFY_IDENTITY</code> 选项，并使用对应的 CA 证书，以验证服务器的身份。</p>

<p>MySQL 的服务端和客户端必须同时启用 <code class="highlighter-rouge">LOCAL</code>，客户端才能使用 <code class="highlighter-rouge">LOAD DATA LOCAL</code> 语句来导入数据，否则会收到如下错误消息：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ERROR 1148 (42000): The used command is not allowed with this MySQL version
</code></pre></div></div>

<p>服务端：</p>

<p>需要在 <code class="highlighter-rouge">/etc/my.cnf</code> 配置文件中的 <code class="highlighter-rouge">[mysqld]</code> 区段设置 <code class="highlighter-rouge">local-infile=1</code>，以便启用服务端的 <code class="highlighter-rouge">LOCAL</code> 功能。</p>

<p>客户端：</p>

<p>在调用 mysql 时要加上 <code class="highlighter-rouge">--local-infile</code> 参数：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql <span class="nt">--local-infile</span> <span class="nt">-u</span> root <span class="nt">-p</span>
</code></pre></div></div>

<p>或者，在 <code class="highlighter-rouge">/etc/my.cnf</code> 配置文件中的 <code class="highlighter-rouge">[mysql]</code> 区段设置 <code class="highlighter-rouge">local-infile=1</code>，启用客户端的 <code class="highlighter-rouge">LOCAL</code> 功能。</p>

<h5 id="用-insert-语句添加记录">用 <code class="highlighter-rouge">INSERT</code> 语句添加记录</h5>

<p>如果要每次增加一条记录，可以使用 <code class="highlighter-rouge">INSERT</code> 语句。</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">album</span>
    <span class="o">-&gt;</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'the Wall'</span><span class="p">,</span> <span class="s1">'Pink Floyd'</span><span class="p">,</span> <span class="s1">'1978-01-01'</span><span class="p">,</span><span class="s1">'rock'</span><span class="p">,</span><span class="k">NULL</span><span class="p">);</span>
</code></pre></div></div>

<p>字符串和日期都被 <strong>引用</strong>，可以为无值的字段 <strong>直接插入 NULL</strong>，无需像编辑文本时用 \N。</p>

<h4 id="从表格中检索信息">从表格中检索信息</h4>

<p>通常使用 <code class="highlighter-rouge">SELECT</code> 语句从表格中检索信息。</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">what</span>
<span class="k">FROM</span> <span class="k">table</span>
<span class="k">WHERE</span> <span class="n">conditions</span><span class="p">;</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">what</code> 可以是要检索的列，或用 <code class="highlighter-rouge">*</code> 表示所有列</p>

<p><code class="highlighter-rouge">table</code> 要检索哪个表格</p>

<p><code class="highlighter-rouge">WHERE</code> 是可选的，如果有，则用 <code class="highlighter-rouge">conditions</code> 来指定检索记录必须满足的条件</p>

<h5 id="选择所有数据">选择所有数据</h5>

<p>用 <code class="highlighter-rouge">SELECT</code> 语句 <strong>查看</strong> 表格 <strong>所有记录</strong>。</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">album</span><span class="p">;</span>
</code></pre></div></div>

<p>如果要 <strong>删除</strong> 表格的 <strong>所有记录</strong>：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">album</span><span class="p">;</span>
</code></pre></div></div>

<p><strong>修改某条记录</strong>：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">UPDATE</span> <span class="n">album</span> <span class="k">SET</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">'the wall'</span> <span class="k">WHERE</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">'wall'</span>
</code></pre></div></div>

<h5 id="选择特定行">选择特定行</h5>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">album</span> <span class="k">WHERE</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">'the wall'</span><span class="p">;</span>
</code></pre></div></div>

<p>过滤条件中的字符串通常是大小写不敏感的。</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">album</span> <span class="k">WHERE</span> <span class="k">year</span> <span class="o">&gt;=</span> <span class="s1">'1980-1-1'</span><span class="p">;</span>
</code></pre></div></div>

<p>可以用组合条件来过滤：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">album</span> <span class="k">WHERE</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">'the wall'</span> <span class="k">AND</span> <span class="n">artist</span> <span class="o">=</span> <span class="s1">'Pink Floyd'</span><span class="p">;</span>
</code></pre></div></div>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">album</span> <span class="k">WHERE</span> <span class="n">artist</span> <span class="o">=</span> <span class="s1">'Pink Floyd'</span> <span class="k">OR</span> <span class="n">artist</span> <span class="o">=</span> <span class="s1">'Cui Jian'</span><span class="p">;</span>
</code></pre></div></div>

<h5 id="选择特定列">选择特定列</h5>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">artist</span><span class="p">,</span> <span class="n">title</span> <span class="k">FROM</span> <span class="n">album</span><span class="p">;</span>
</code></pre></div></div>

<p>要想让重复的行只显示一次，可以使用 <code class="highlighter-rouge">DISTINCT</code> 参数：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">DISTINT</span> <span class="n">title</span> <span class="k">FROM</span> <span class="n">album</span><span class="p">;</span>
</code></pre></div></div>

<p>与 <strong>条件过滤</strong> 配合使用：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">title</span><span class="p">,</span> <span class="n">artist</span> <span class="k">WHERE</span> <span class="k">year</span> <span class="o">&gt;=</span> <span class="s1">'1999-9-9'</span><span class="p">;</span>
</code></pre></div></div>

<h5 id="为行排序">为行排序</h5>

<p>用 <code class="highlighter-rouge">ORDER BY</code> 子句来为检索的行排序：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">title</span><span class="p">,</span> <span class="n">artist</span> <span class="k">FROM</span> <span class="n">album</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="k">year</span><span class="p">;</span>
</code></pre></div></div>

<p>默认为升序排列，如需降序排列可以在后面加上 <code class="highlighter-rouge">DESC</code>：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">title</span><span class="p">,</span> <span class="n">artist</span> <span class="k">FROM</span> <span class="n">album</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="k">year</span> <span class="k">DESC</span><span class="p">;</span>
</code></pre></div></div>

<h5 id="计算日期">计算日期</h5>

<p>现有表格 <code class="highlighter-rouge">pet</code>，记录宠物的基本信息，字段为：<code class="highlighter-rouge">name</code>、<code class="highlighter-rouge">owner</code>、<code class="highlighter-rouge">species</code>、<code class="highlighter-rouge">sex</code>、<code class="highlighter-rouge">birth</code>、<code class="highlighter-rouge">death</code> 。</p>

<p>MySQL 提供了几种计算日期的函数。如 <code class="highlighter-rouge">TIMESTAMPDIFF</code> 函数可以用两个日期来计算它们之间的年数。</p>

<p>如表格中有宠物名、生日，则可以用该函数来计算每个宠物的年龄：</p>

<p><code class="highlighter-rouge">TIMESTAMPDIFF(YEAR,birth,CURDATE())</code> 表示计算 <code class="highlighter-rouge">birth</code> 与 <code class="highlighter-rouge">CURDATE()</code> 这两个日期差了几年。</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">birth</span><span class="p">,</span> <span class="n">CURDATE</span><span class="p">(),</span>
    <span class="o">-&gt;</span> <span class="n">TIMESTAMPDIFF</span><span class="p">(</span><span class="k">YEAR</span><span class="p">,</span><span class="n">birth</span><span class="p">,</span><span class="n">CURDATE</span><span class="p">())</span> <span class="k">AS</span> <span class="n">age</span>
    <span class="o">-&gt;</span> <span class="k">FROM</span> <span class="n">pet</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">age</span><span class="p">;</span>
	<span class="o">+</span><span class="c1">----------+------------+------------+------+</span>
	<span class="o">|</span> <span class="n">name</span>     <span class="o">|</span> <span class="n">birth</span>      <span class="o">|</span> <span class="n">CURDATE</span><span class="p">()</span>  <span class="o">|</span> <span class="n">age</span>  <span class="o">|</span>
	<span class="o">+</span><span class="c1">----------+------------+------------+------+</span>
	<span class="o">|</span> <span class="n">Chirpy</span>   <span class="o">|</span> <span class="mi">1998</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">11</span> <span class="o">|</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">19</span> <span class="o">|</span>    <span class="mi">4</span> <span class="o">|</span>
	<span class="o">|</span> <span class="n">Puffball</span> <span class="o">|</span> <span class="mi">1999</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">30</span> <span class="o">|</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">19</span> <span class="o">|</span>    <span class="mi">4</span> <span class="o">|</span>
	<span class="o">|</span> <span class="n">Whistler</span> <span class="o">|</span> <span class="mi">1997</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">09</span> <span class="o">|</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">19</span> <span class="o">|</span>    <span class="mi">5</span> <span class="o">|</span>
	<span class="o">|</span> <span class="n">Slim</span>     <span class="o">|</span> <span class="mi">1996</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">29</span> <span class="o">|</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">19</span> <span class="o">|</span>    <span class="mi">7</span> <span class="o">|</span>
	<span class="o">|</span> <span class="n">Claws</span>    <span class="o">|</span> <span class="mi">1994</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">17</span> <span class="o">|</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">19</span> <span class="o">|</span>    <span class="mi">9</span> <span class="o">|</span>
	<span class="o">|</span> <span class="n">Fluffy</span>   <span class="o">|</span> <span class="mi">1993</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">04</span> <span class="o">|</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">19</span> <span class="o">|</span>   <span class="mi">10</span> <span class="o">|</span>
	<span class="o">|</span> <span class="n">Fang</span>     <span class="o">|</span> <span class="mi">1990</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">27</span> <span class="o">|</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">19</span> <span class="o">|</span>   <span class="mi">12</span> <span class="o">|</span>
	<span class="o">|</span> <span class="n">Bowser</span>   <span class="o">|</span> <span class="mi">1989</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">31</span> <span class="o">|</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">19</span> <span class="o">|</span>   <span class="mi">13</span> <span class="o">|</span>
	<span class="o">|</span> <span class="n">Buffy</span>    <span class="o">|</span> <span class="mi">1989</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">13</span> <span class="o">|</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">19</span> <span class="o">|</span>   <span class="mi">14</span> <span class="o">|</span>
	<span class="o">+</span><span class="c1">----------+------------+------------+------+</span>
</code></pre></div></div>

<p>其中 CURDATE() 为当前日期，age 为计算出来的年龄。这两列都是由 <code class="highlighter-rouge">SELECT</code> 语句生成的，不在表格中。</p>

<p>下例为从宠物统计表格中为死去的宠物计算寿命：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">birth</span><span class="p">,</span> <span class="n">death</span><span class="p">,</span>
    <span class="o">-&gt;</span> <span class="n">TIMESTAMPDIFF</span><span class="p">(</span><span class="k">YEAR</span><span class="p">,</span><span class="n">birth</span><span class="p">,</span><span class="n">death</span><span class="p">)</span> <span class="k">AS</span> <span class="n">age</span>
    <span class="o">-&gt;</span> <span class="k">FROM</span> <span class="n">pet</span> <span class="k">WHERE</span> <span class="n">death</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">age</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------+------------+------------+------+</span>
<span class="o">|</span> <span class="n">name</span>   <span class="o">|</span> <span class="n">birth</span>      <span class="o">|</span> <span class="n">death</span>      <span class="o">|</span> <span class="n">age</span>  <span class="o">|</span>
<span class="o">+</span><span class="c1">--------+------------+------------+------+</span>
<span class="o">|</span> <span class="n">Bowser</span> <span class="o">|</span> <span class="mi">1989</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">31</span> <span class="o">|</span> <span class="mi">1995</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">29</span> <span class="o">|</span>    <span class="mi">5</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">--------+------------+------------+------+</span>
</code></pre></div></div>

<p>因为 NULL 是一个特殊的值，它不能用 <code class="highlighter-rouge">&lt;&gt;</code> 操作符来比较。</p>

<p>检索哪个宠物下月过生日：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">birth</span> <span class="k">FROM</span> <span class="n">pet</span> <span class="k">WHERE</span> <span class="k">MONTH</span><span class="p">(</span><span class="n">birth</span><span class="p">)</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-------+------------+</span>
<span class="o">|</span> <span class="n">name</span>  <span class="o">|</span> <span class="n">birth</span>      <span class="o">|</span>
<span class="o">+</span><span class="c1">-------+------------+</span>
<span class="o">|</span> <span class="n">Buffy</span> <span class="o">|</span> <span class="mi">1989</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">13</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-------+------------+</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">MONTH(birth) = 5</code> 表示 <code class="highlighter-rouge">birth</code> 日期中的月份为 5。</p>

<h5 id="空值的使用">空值的使用</h5>

<p><code class="highlighter-rouge">NULL</code> 做为空值使用。</p>

<p>要测试某字段是否空值，只可以用 <code class="highlighter-rouge">IS NULL</code> 和 <code class="highlighter-rouge">IS NOT NULL</code>：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="mi">1</span> <span class="k">IS</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">1</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">;</span>
</code></pre></div></div>

<p>不能使用 <code class="highlighter-rouge">=</code>、<code class="highlighter-rouge">&lt;</code>、<code class="highlighter-rouge">&lt;&gt;</code> 这些算术比较符来测试 <code class="highlighter-rouge">NULL</code>，因为任何算术比较符与 <code class="highlighter-rouge">NULL</code> 比较之后的结果仍是 <code class="highlighter-rouge">NULL</code>。</p>

<p>在 MySQL 中，<code class="highlighter-rouge">0</code> 或 <code class="highlighter-rouge">NULL</code> 代表逻辑假，任何其它的都代表逻辑真。布尔操作的真默认用 <code class="highlighter-rouge">1</code> 来表示。</p>

<p>事实上，空字符并不等于 <code class="highlighter-rouge">NULL</code>：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="mi">0</span> <span class="k">IS</span> <span class="k">NULL</span><span class="p">,</span> <span class="mi">0</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span> <span class="s1">''</span> <span class="k">IS</span> <span class="k">NULL</span><span class="p">,</span> <span class="s1">''</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">;</span>
<span class="o">+</span><span class="c1">-----------+---------------+------------+----------------+</span>
<span class="o">|</span> <span class="mi">0</span> <span class="k">IS</span> <span class="k">NULL</span> <span class="o">|</span> <span class="mi">0</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="o">|</span> <span class="s1">''</span> <span class="k">IS</span> <span class="k">NULL</span> <span class="o">|</span> <span class="s1">''</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+---------------+------------+----------------+</span>
<span class="o">|</span>         <span class="mi">0</span> <span class="o">|</span>             <span class="mi">1</span> <span class="o">|</span>          <span class="mi">0</span> <span class="o">|</span>              <span class="mi">1</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+---------------+------------+----------------+</span>
</code></pre></div></div>

<h5 id="模式匹配">模式匹配</h5>

<p>MySQL 使用标准的 SQL 模式匹配，基于扩展正则表达式。</p>

<p><code class="highlighter-rouge">_</code> 匹配任何单个字符</p>

<p><code class="highlighter-rouge">%</code> 匹配任意数量的字符，包括 0 个字符。</p>

<p>模式匹配中，默认是大小写不敏感的。</p>

<p>匹配的操作符是 <code class="highlighter-rouge">LIKE</code> 或 <code class="highlighter-rouge">NOT LIKE</code>，而不是习惯中的 <code class="highlighter-rouge">=</code> 或 <code class="highlighter-rouge">&lt;&gt;</code>。</p>

<h6 id="通配符">通配符</h6>

<p>以 <code class="highlighter-rouge">b</code> 开头的名字：</p>

<p><code class="highlighter-rouge">SELECT * FROM pet WHERE name LIKE 'b%';</code></p>

<p>以 <code class="highlighter-rouge">fy</code> 结尾的名字：</p>

<p><code class="highlighter-rouge">SELECT * FROM pet WHERE name LIKE '%fy';</code></p>

<p>包含 <code class="highlighter-rouge">w</code> 的名字：</p>

<p><code class="highlighter-rouge">SELECT * FROM pet WHERE name LIKE '%w%';</code></p>

<p>五个字符的名字：</p>

<p><code class="highlighter-rouge">SELECT * FROM pet WHERE name LIKE '_____';</code></p>

<h6 id="扩展正则表达式">扩展正则表达式</h6>

<p>通过 <code class="highlighter-rouge">REGEXP_LIE()</code> 函数来匹配正则表达式。</p>

<p>匹配行中的名字以 <code class="highlighter-rouge">b</code> 开头：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">pet</span> <span class="k">WHERE</span> <span class="n">REGEXP_LIKE</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">'^b'</span><span class="p">);</span>
</code></pre></div></div>

<p>如果需要在匹配时 <strong>大小写敏感</strong>，可以加上 <code class="highlighter-rouge">c</code> 这个匹配控制字符：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">pet</span> <span class="k">WHERE</span> <span class="n">REGEXP_LIKE</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">'^b'</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">);</span>
</code></pre></div></div>

<p>匹配行中的名字以 <code class="highlighter-rouge">fy</code> 结尾：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">pet</span> <span class="k">WHERE</span> <span class="n">REGEXP_LIKE</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">'fy$'</span><span class="p">);</span>
</code></pre></div></div>

<p>匹配行中的名字中包含 <code class="highlighter-rouge">w</code> ：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">pet</span> <span class="k">WHERE</span> <span class="n">REGEXP_LIKE</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">);</span>
</code></pre></div></div>

<p>匹配行中的名字为 5 个字符：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">pet</span> <span class="k">WHERE</span> <span class="n">REGEXP_LIKE</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">'^.{5}$'</span><span class="p">);</span>
</code></pre></div></div>

<h5 id="统计行数">统计行数</h5>

<h6 id="显示所有字段">显示所有字段</h6>

<p>统计行数时，要显示表格所有字段，则 <code class="highlighter-rouge">SELECT</code> 后面不指定字段名。统计表格所有行数：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">pet</span><span class="p">;</span>
</code></pre></div></div>

<h6 id="显示特定字段">显示特定字段</h6>

<p>统计行数时，要想显示指定的字段，则必须在 <code class="highlighter-rouge">SELECT</code> 语句后指明要显示的字段，同时，还要用该字段来排序，即 <code class="highlighter-rouge">GROUP BY</code> 相同的字段。这样才能正常显示。</p>

<p>为检索的信息统计行数：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">owner</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">pet</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="k">owner</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------+----------+</span>
<span class="o">|</span> <span class="k">owner</span>  <span class="o">|</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">--------+----------+</span>
<span class="o">|</span> <span class="n">Benny</span>  <span class="o">|</span>        <span class="mi">2</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Diane</span>  <span class="o">|</span>        <span class="mi">2</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Gwen</span>   <span class="o">|</span>        <span class="mi">3</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Harold</span> <span class="o">|</span>        <span class="mi">2</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">--------+----------+</span>
</code></pre></div></div>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">species</span><span class="p">,</span> <span class="n">sex</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">pet</span>
    <span class="o">-&gt;</span> <span class="k">WHERE</span> <span class="n">species</span> <span class="o">=</span> <span class="s1">'dog'</span> <span class="k">OR</span> <span class="n">species</span> <span class="o">=</span> <span class="s1">'cat'</span>
    <span class="o">-&gt;</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">species</span><span class="p">,</span> <span class="n">sex</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------+------+----------+</span>
<span class="o">|</span> <span class="n">species</span> <span class="o">|</span> <span class="n">sex</span>  <span class="o">|</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">---------+------+----------+</span>
<span class="o">|</span> <span class="n">cat</span>     <span class="o">|</span> <span class="n">f</span>    <span class="o">|</span>        <span class="mi">1</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">cat</span>     <span class="o">|</span> <span class="n">m</span>    <span class="o">|</span>        <span class="mi">1</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">dog</span>     <span class="o">|</span> <span class="n">f</span>    <span class="o">|</span>        <span class="mi">1</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">dog</span>     <span class="o">|</span> <span class="n">m</span>    <span class="o">|</span>        <span class="mi">2</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">---------+------+----------+</span>
</code></pre></div></div>

<h5 id="使用多个表格">使用多个表格</h5>

<h6 id="连接两个不同的表格">连接两个不同的表格</h6>

<p>在 <code class="highlighter-rouge">pet</code> 表格基础上，再增加一个表格 <code class="highlighter-rouge">event</code>，保存宠物的一些经历，如看病记录、生崽记录等。字段为 <code class="highlighter-rouge">name</code>、<code class="highlighter-rouge">date</code>、<code class="highlighter-rouge">type</code>、<code class="highlighter-rouge">remakr</code>。</p>

<p>假设现在你想了解这些宠物在哪些年龄段会生育，<code class="highlighter-rouge">event</code> 表格中有生育的记录，但没有年龄。没关系，我们可以根据生育记录中的日期来计算当时的年龄，因此又需要 <code class="highlighter-rouge">pet</code> 表格。这意味着这个查询同时需要两张表格的数据：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">pet</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
    <span class="o">-&gt;</span> <span class="n">TIMESTAMPDIFF</span><span class="p">(</span><span class="k">YEAR</span><span class="p">,</span><span class="n">birth</span><span class="p">,</span><span class="n">date</span><span class="p">)</span> <span class="k">AS</span> <span class="n">age</span><span class="p">,</span>
    <span class="o">-&gt;</span> <span class="n">remark</span>
    <span class="o">-&gt;</span> <span class="k">FROM</span> <span class="n">pet</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">event</span>
    <span class="o">-&gt;</span>   <span class="k">ON</span> <span class="n">pet</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">event</span><span class="p">.</span><span class="n">name</span>
    <span class="o">-&gt;</span> <span class="k">WHERE</span> <span class="n">event</span><span class="p">.</span><span class="k">type</span> <span class="o">=</span> <span class="s1">'litter'</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------+------+-----------------------------+</span>
<span class="o">|</span> <span class="n">name</span>   <span class="o">|</span> <span class="n">age</span>  <span class="o">|</span> <span class="n">remark</span>                      <span class="o">|</span>
<span class="o">+</span><span class="c1">--------+------+-----------------------------+</span>
<span class="o">|</span> <span class="n">Fluffy</span> <span class="o">|</span>    <span class="mi">2</span> <span class="o">|</span> <span class="mi">4</span> <span class="n">kittens</span><span class="p">,</span> <span class="mi">3</span> <span class="n">female</span><span class="p">,</span> <span class="mi">1</span> <span class="n">male</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Buffy</span>  <span class="o">|</span>    <span class="mi">4</span> <span class="o">|</span> <span class="mi">5</span> <span class="n">puppies</span><span class="p">,</span> <span class="mi">2</span> <span class="n">female</span><span class="p">,</span> <span class="mi">3</span> <span class="n">male</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Buffy</span>  <span class="o">|</span>    <span class="mi">5</span> <span class="o">|</span> <span class="mi">3</span> <span class="n">puppies</span><span class="p">,</span> <span class="mi">3</span> <span class="n">female</span>         <span class="o">|</span>
<span class="o">+</span><span class="c1">--------+------+-----------------------------+</span>
</code></pre></div></div>

<p>从该查询我们可以学习到：</p>

<ul>
  <li><code class="highlighter-rouge">FROM</code> 子句会把两张表格连起来，因为需要同时从两张表格中提取数据。</li>
  <li>要想把两张表格中对应的数据连起来，必须要指定一张表格中的记录要如何匹配另一表格中的记录。因为两张表格共同的字段为 <code class="highlighter-rouge">name</code>，因此我们基于 <code class="highlighter-rouge">name</code> 的值，使用 <code class="highlighter-rouge">ON</code> 子句来匹配两张表中同一名字对应的记录。</li>
  <li>使用 <code class="highlighter-rouge">INNER JOIN</code> 连接两张表。然后通过 <code class="highlighter-rouge">ON</code> 子句来指明，必须在两张表中同时存在该字段的同一个值，该行才被匹配。</li>
  <li>因为 <code class="highlighter-rouge">name</code> 在两张表中都有，为了区分不同表的字段，在 <code class="highlighter-rouge">name</code> 前面用表格名称做前缀 <code class="highlighter-rouge">pet.name</code>。</li>
</ul>

<h6 id="连接同一个表格">连接同一个表格</h6>

<p>不是非要两个不同的表格才能进行连接，有时候甚至可以连接自己。</p>

<p>如果想要比较同一表格中的不同记录，就可以连接同一表格。</p>

<p>例如，想要在同一种宠物间匹配一对来生育：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">p1</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">p1</span><span class="p">.</span><span class="n">sex</span><span class="p">,</span> <span class="n">p2</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">p2</span><span class="p">.</span><span class="n">sex</span><span class="p">,</span> <span class="n">p1</span><span class="p">.</span><span class="n">species</span>
    <span class="o">-&gt;</span> <span class="k">FROM</span> <span class="n">pet</span> <span class="k">AS</span> <span class="n">p1</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">pet</span> <span class="k">AS</span> <span class="n">p2</span>
    <span class="o">-&gt;</span>   <span class="k">ON</span> <span class="n">p1</span><span class="p">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">p2</span><span class="p">.</span><span class="n">species</span> <span class="k">AND</span> <span class="n">p1</span><span class="p">.</span><span class="n">sex</span> <span class="o">=</span> <span class="s1">'f'</span> <span class="k">AND</span> <span class="n">p2</span><span class="p">.</span><span class="n">sex</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------+------+--------+------+---------+</span>
<span class="o">|</span> <span class="n">name</span>   <span class="o">|</span> <span class="n">sex</span>  <span class="o">|</span> <span class="n">name</span>   <span class="o">|</span> <span class="n">sex</span>  <span class="o">|</span> <span class="n">species</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">--------+------+--------+------+---------+</span>
<span class="o">|</span> <span class="n">Fluffy</span> <span class="o">|</span> <span class="n">f</span>    <span class="o">|</span> <span class="n">Claws</span>  <span class="o">|</span> <span class="n">m</span>    <span class="o">|</span> <span class="n">cat</span>     <span class="o">|</span>
<span class="o">|</span> <span class="n">Buffy</span>  <span class="o">|</span> <span class="n">f</span>    <span class="o">|</span> <span class="n">Fang</span>   <span class="o">|</span> <span class="n">m</span>    <span class="o">|</span> <span class="n">dog</span>     <span class="o">|</span>
<span class="o">|</span> <span class="n">Buffy</span>  <span class="o">|</span> <span class="n">f</span>    <span class="o">|</span> <span class="n">Bowser</span> <span class="o">|</span> <span class="n">m</span>    <span class="o">|</span> <span class="n">dog</span>     <span class="o">|</span>
<span class="o">+</span><span class="c1">--------+------+--------+------+---------+</span>
</code></pre></div></div>

<p>重要一点是要在 <code class="highlighter-rouge">FROM</code> 子句中为表格起两个不同的别名，然后用不同的别名来匹配。</p>

<h3 id="查看数据库和表格的信息">查看数据库和表格的信息</h3>

<p>查看当前 <strong>在用的数据库</strong>：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">DATABASE</span><span class="p">();</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span> <span class="k">DATABASE</span><span class="p">()</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
<span class="o">|</span> <span class="n">menagerie</span>  <span class="o">|</span>
<span class="o">+</span><span class="c1">------------+</span>
</code></pre></div></div>

<p>如果当前没有使用任何数据库，返回结果为 <code class="highlighter-rouge">NULL</code>。</p>

<p>查看在用数据库包含哪些表：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SHOW</span> <span class="n">TABLES</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span> <span class="n">Tables_in_menagerie</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span> <span class="n">event</span>               <span class="o">|</span>
<span class="o">|</span> <span class="n">pet</span>                 <span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
</code></pre></div></div>

<p>查看表格的结构：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">DESCRIBE</span> <span class="n">pet</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------+-------------+------+-----+---------+-------+</span>
<span class="o">|</span> <span class="n">Field</span>   <span class="o">|</span> <span class="k">Type</span>        <span class="o">|</span> <span class="k">Null</span> <span class="o">|</span> <span class="k">Key</span> <span class="o">|</span> <span class="k">Default</span> <span class="o">|</span> <span class="n">Extra</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">---------+-------------+------+-----+---------+-------+</span>
<span class="o">|</span> <span class="n">name</span>    <span class="o">|</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">|</span> <span class="n">YES</span>  <span class="o">|</span>     <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="k">owner</span>   <span class="o">|</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">|</span> <span class="n">YES</span>  <span class="o">|</span>     <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">species</span> <span class="o">|</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">|</span> <span class="n">YES</span>  <span class="o">|</span>     <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">sex</span>     <span class="o">|</span> <span class="n">char</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>     <span class="o">|</span> <span class="n">YES</span>  <span class="o">|</span>     <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">birth</span>   <span class="o">|</span> <span class="n">date</span>        <span class="o">|</span> <span class="n">YES</span>  <span class="o">|</span>     <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">death</span>   <span class="o">|</span> <span class="n">date</span>        <span class="o">|</span> <span class="n">YES</span>  <span class="o">|</span>     <span class="o">|</span> <span class="k">NULL</span>    <span class="o">|</span>       <span class="o">|</span>
<span class="o">+</span><span class="c1">---------+-------------+------+-----+---------+-------+</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">key</code> 表示该字段是否被索引</p>

<p><code class="highlighter-rouge">Default</code> 表示该字段的默认值</p>

<p><code class="highlighter-rouge">Extra</code> 表示该字段的特殊信息。如果建表时使用了 <code class="highlighter-rouge">AUTO_INCREMENT</code> 选项，该值将是 <code class="highlighter-rouge">auto_increment</code></p>

<h3 id="mysql-批处理模式">MySQL 批处理模式</h3>

<p>除了以交互模式运行 MySQL 外，还可以以批处理模式来运行。可以把语句保存到文件中，然后让 mysql 云读取：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>mysql &lt; batch-file
</code></pre></div></div>

<p>也可以指定一些连接的参数：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>mysql <span class="nt">-h</span> host <span class="nt">-u</span> user <span class="nt">-p</span> &lt; batch-file
</code></pre></div></div>

<p>如果希望执行脚本期间即使遇到错误也继续执行，可以用 <code class="highlighter-rouge">--force</code> 选项。</p>

<h4 id="使用脚本的好处">使用脚本的好处</h4>

<ul>
  <li>如果需要频繁地进行查询，做成脚本可以省去很多敲命令的时间</li>
  <li>可以很方便从现有查询中复制，修改成新的查询</li>
  <li>对于多条语句的查询，发现错误，在脚本里很快就能修改，不用重复敲命令</li>
  <li>如果查询的输出特别多，在批处理模式中可以借助管道逐页查看，或干脆重定向到文件中</li>
  <li>脚本便于分享</li>
  <li>可以用于 <code class="highlighter-rouge">cron</code></li>
</ul>

<h4 id="批处理的选项">批处理的选项</h4>

<p>使用批处理模式时，默认其输出会更加简洁，去掉了表格装饰线条。如果希望输出同交互式输出一样，可以使用 <code class="highlighter-rouge">mysql -t</code> 选项。</p>

<p>使用 <code class="highlighter-rouge">mysql -v</code> 来回显每条语句。</p>

<h4 id="另一种运行批处理的方法">另一种运行批处理的方法</h4>

<p>也可以在 mysql 提示符中，使用 <code class="highlighter-rouge">source</code> 命令 或 <code class="highlighter-rouge">\.</code> 来运行脚本：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">source</span> <span class="n">filename</span><span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="err">\</span><span class="p">.</span> <span class="n">filename</span>
</code></pre></div></div>

<h3 id="与-apache-配合使用-mysql">与 Apache 配合使用 MySQL</h3>

<p>有一些程序需要使用 MySQL 数据库来进行用户的验证，或者把日志文件写入 MySQL 表。</p>

<p>通过修改 Apache 配置文件，我们可以修改其日志的格式，以便更利于被 MySQL 读取。</p>

<p>可以用以下语句把 Apache 日志文件导入 MySQL：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">LOAD</span> <span class="k">DATA</span> <span class="n">INFILE</span> <span class="s1">'/local/access_log'</span> <span class="k">INTO</span> <span class="k">TABLE</span> <span class="n">tbl_name</span>
<span class="n">FIELDS</span> <span class="n">TERMINATED</span> <span class="k">BY</span> <span class="s1">','</span> <span class="n">OPTIONALLY</span> <span class="n">ENCLOSED</span> <span class="k">BY</span> <span class="s1">'"'</span> <span class="n">ESCAPED</span> <span class="k">BY</span> <span class="s1">'</span><span class="se">\\</span><span class="s1">'</span>
</code></pre></div></div>

<p>当然，提前做好一个空表，把字段与日志文件相对应。</p>

        
      </section>




      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
	<hr />
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> 标签: </strong>
    <span itemprop="keywords">
    
		
      <a href="/tag/mysql" class="page__taxonomy-item" rel="tag">mysql</a>
    
    </span>
  </p>













  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> 分类: </strong>
	<!--  <hr />    -->
    <span itemprop="keywords">
    
      
      
      <a href="http://localhost:4000/categories/#database" class="page__taxonomy-item" rel="tag">database</a>
    
    </span>
  </p>




        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 更新时间:</strong> <time datetime="2016-03-01T00:00:00+08:00">March 01, 2016</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">分享</h4>
  

  <a href="https://twitter.com/intent/tweet?via=liloli&text=MySQL+%E5%85%A5%E9%97%A8%20http%3A%2F%2Flocalhost%3A4000%2Fdatabase%2Fmysql_intro%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="分享 Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fdatabase%2Fmysql_intro%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="分享 Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http%3A%2F%2Flocalhost%3A4000%2Fdatabase%2Fmysql_intro%2F" class="btn btn--google-plus" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="分享 Google Plus"><i class="fab fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fdatabase%2Fmysql_intro%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="分享 LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="http://localhost:4000/database/mysql_backup/" class="pagination--pager" title="MySQL 的备份与恢复
">向前</a>
    
    
      <a href="http://localhost:4000/database/mysql_security/" class="pagination--pager" title="MySQL 的安全
">向后</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">猜您还喜欢</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/bash/time/" rel="permalink">Bash 脚本 - 时间
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/bash/storage/" rel="permalink">Bash 脚本 - 存储空间
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/bash/numbers/" rel="permalink">Bash 脚本 - 数字
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4000/bash/input/" rel="permalink">Bash 脚本 - 输入
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>
        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap">
  <input type="text" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  <div id="results" class="results"></div>
</div>
      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->


<!-- end custom footer snippets -->

        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>关注:</strong></li>
    
    
      <li><a href="https://twitter.com/liloli"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
      <li><a href="https://www.facebook.com/lilolibj"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i> Facebook</a></li>
    
    
      <li><a href="https://github.com/liloli"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    
    <li><a href="http://localhost:4000/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2018 Hawk Zhang. 技术来自于 <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="http://localhost:4000/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>



  
  
  <script src="http://localhost:4000/assets/js/lunr/lunr.min.js"></script>
  <script src="http://localhost:4000/assets/js/lunr/lunr-store.js"></script>
  <script src="http://localhost:4000/assets/js/lunr/lunr-en.js"></script>





    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/database/mysql_intro/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/database/mysql_intro"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://liloli.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  



  </body>
</html>
